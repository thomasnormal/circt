if(MLIR_ENABLE_EXECUTION_ENGINE)
  add_compile_definitions(CIRCT_LEC_ENABLE_JIT)
  set(CIRCT_LEC_JIT_LLVM_COMPONENTS native)
  set(CIRCT_LEC_JIT_DEPS
    MLIRExecutionEngine
    MLIRExecutionEngineUtils
  )
  # Link Z3 for JIT runtime - symbols like Z3_del_config, Z3_del_context are
  # called at runtime by the JIT-compiled code generated by SMTToZ3LLVM.
  # When Z3 is found via CONFIG mode, z3::libz3 target is available
  # When found via FindZ3 module, Z3_LIBRARIES is set
  if(TARGET z3::libz3)
    list(APPEND CIRCT_LEC_JIT_DEPS z3::libz3)
  elseif(Z3_LIBRARIES)
    list(APPEND CIRCT_LEC_JIT_DEPS ${Z3_LIBRARIES})
  endif()
endif()

set(LLVM_LINK_COMPONENTS Support ${CIRCT_LEC_JIT_LLVM_COMPONENTS})

add_circt_tool(circt-lec circt-lec.cpp)
target_link_libraries(circt-lec
  PRIVATE
  CIRCTComb
  CIRCTCombToSMT
  CIRCTDatapath
  CIRCTDatapathToSMT
  CIRCTBMCTransforms
  CIRCTEmitTransforms
  CIRCTHW
  CIRCTHWTransforms
  CIRCTHWToSMT
  CIRCTImportVerilog
  CIRCTLECTransforms
  CIRCTOMTransforms
  CIRCTSim
  CIRCTSimTransforms
  CIRCTSMTToZ3LLVM
  CIRCTTransforms
  CIRCTSupport
  CIRCTVerif
  CIRCTVerifToSMT
  LLVMSupport
  MLIRArithDialect
  MLIRBuiltinToLLVMIRTranslation
  MLIRFuncDialect
  MLIRFuncInlinerExtension
  MLIRIR
  MLIRLLVMIRTransforms
  MLIRLLVMToLLVMIRTranslation
  MLIRLLVMToLLVMIRTranslation
  MLIRSMT
  MLIRTargetLLVMIRExport
  MLIRExportSMTLIB

  ${CIRCT_LEC_JIT_DEPS}
)

llvm_update_compile_flags(circt-lec)
mlir_check_all_link_libraries(circt-lec)
