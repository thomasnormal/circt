// RUN: rm -rf %t && mkdir -p %t/proj %t/scripts
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\necho SCRIPT:run_mutation_matrix.sh\nfor a in "$@"; do echo ARG:$a; done\n' > %t/scripts/run_mutation_matrix.sh
// RUN: chmod +x %t/scripts/run_mutation_matrix.sh
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/scripts/fake-circt-lec.sh
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/scripts/fake-circt-bmc.sh
// RUN: chmod +x %t/scripts/fake-circt-lec.sh %t/scripts/fake-circt-bmc.sh
// RUN: printf 'lane1\tdesign.il\tmutations.txt\ttests.tsv\t-\t-\t-\n' > %t/proj/lanes.tsv
// RUN: printf '[matrix]\nlanes_tsv = "lanes.tsv"\nout_dir = "out/matrix"\ndefault_formal_global_propagate_timeout_seconds = 0\ndefault_mutations_modes = "arith,control"\ndefault_mutations_mode_weights = "arith=3,control=1"\ndefault_formal_global_propagate_circt_lec = "%t/scripts/fake-circt-lec.sh"\ndefault_formal_global_propagate_circt_bmc = "%t/scripts/fake-circt-bmc.sh"\ndefault_formal_global_propagate_circt_chain = "auto"\nskip_baseline = true\n' > %t/proj/circt-mut.toml
// RUN: env CIRCT_MUT_SCRIPTS_DIR=%t/scripts circt-mut run --project-dir %t/proj --mode matrix > %t/out.txt
// RUN: FileCheck %s < %t/out.txt
//
// CHECK: SCRIPT:run_mutation_matrix.sh
// CHECK-DAG: ARG:--lanes-tsv
// CHECK-DAG: ARG:{{.*}}/lanes.tsv
// CHECK-DAG: ARG:--out-dir
// CHECK-DAG: ARG:{{.*}}/out/matrix
// CHECK-DAG: ARG:--default-formal-global-propagate-timeout-seconds
// CHECK-DAG: ARG:0
// CHECK-DAG: ARG:--default-mutations-modes
// CHECK-DAG: ARG:arith,control
// CHECK-DAG: ARG:--default-mutations-mode-weights
// CHECK-DAG: ARG:arith=3,control=1
// CHECK-DAG: ARG:--default-formal-global-propagate-circt-chain
// CHECK-DAG: ARG:auto
// CHECK-DAG: ARG:--default-formal-global-propagate-circt-lec
// CHECK-DAG: ARG:{{.*}}/scripts/fake-circt-lec.sh
// CHECK-DAG: ARG:--default-formal-global-propagate-circt-bmc
// CHECK-DAG: ARG:{{.*}}/scripts/fake-circt-bmc.sh
// CHECK-DAG: ARG:--skip-baseline
