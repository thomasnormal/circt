// RUN: rm -rf %t && mkdir -p %t/examples/alpha %t/bin
// RUN: printf 'module top_alpha(input logic a, output logic y); assign y = a; endmodule\n' > %t/examples/alpha/alpha.v
// RUN: printf 'alpha\talpha/alpha.v\ttop_alpha\t-\t-\t-\t-\t-\t-\t-\t-\t-\t-\t-\t-\t0\t0\t-\t-\t34\t25\n' > %t/manifest.tsv
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nsubcmd="$1"\nshift\nif [[ "$subcmd" != "cover" ]]; then\n  echo "expected cover subcommand" >&2\n  exit 9\nfi\nwork_dir=""\nwhile [[ $# -gt 0 ]]; do\n  case "$1" in\n    --work-dir) work_dir="$2"; shift 2 ;;&\n    --work-dir=*) work_dir="${1#*=}"; shift ;;&\n    *) shift ;;&\n  esac\ndone\nmkdir -p "$work_dir"\nprintf "detected_mutants\\t2\\nrelevant_mutants\\t3\\nerrors\\t0\\n" > "$work_dir/metrics.tsv"\n' > %t/bin/circt-mut
// RUN: chmod +x %t/bin/circt-mut
// RUN: printf 'example\tstatus\texit_code\tdetected\trelevant\tcoverage_percent\terrors\nalpha\tPASS\t0\t3\t4\t75.00\t0\n' > %t/baseline.tsv

// RUN: %S/../../utils/run_mutation_mcy_examples.sh \
// RUN:   --examples-root %t/examples \
// RUN:   --example-manifest %t/manifest.tsv \
// RUN:   --circt-mut %t/bin/circt-mut \
// RUN:   --smoke \
// RUN:   --baseline-file %t/baseline.tsv \
// RUN:   --fail-on-diff \
// RUN:   --max-detected-drop 0 \
// RUN:   --max-detected-drop-percent 0 \
// RUN:   --max-relevant-drop 0 \
// RUN:   --max-relevant-drop-percent 0 \
// RUN:   --max-coverage-drop-percent 10 \
// RUN:   --max-errors-increase 0 \
// RUN:   --max-total-detected-drop 1 \
// RUN:   --max-total-detected-drop-percent 34 \
// RUN:   --max-total-relevant-drop 1 \
// RUN:   --max-total-relevant-drop-percent 25 \
// RUN:   --max-total-coverage-drop-percent 10 \
// RUN:   --max-total-errors-increase 0 \
// RUN:   --out-dir %t/out

// RUN: FileCheck %s --check-prefix=SUMMARY < %t/out/summary.tsv
// RUN: FileCheck %s --check-prefix=DRIFT < %t/out/drift.tsv

// SUMMARY: alpha{{[[:space:]]}}PASS{{[[:space:]]}}0{{[[:space:]]}}2{{[[:space:]]}}3{{[[:space:]]}}66.67{{[[:space:]]}}0
// DRIFT: alpha{{[[:space:]]}}detected_mutants{{[[:space:]]}}3{{[[:space:]]}}2{{[[:space:]]}}ok
// DRIFT: alpha{{[[:space:]]}}relevant_mutants{{[[:space:]]}}4{{[[:space:]]}}3{{[[:space:]]}}ok
