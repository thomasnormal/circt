// RUN: rm -rf %t && mkdir -p %t/examples/alpha %t/examples/beta %t/bin
// RUN: printf 'module top_alpha(input logic a, output logic y); assign y = a; endmodule\n' > %t/examples/alpha/alpha.v
// RUN: printf 'module top_beta(input logic a, output logic y); assign y = a; endmodule\n' > %t/examples/beta/beta.v
// RUN: printf 'alpha\talpha/alpha.v\ttop_alpha\t9\t3\tarith\t-\t-\tfault-basic\tweight_cover=7\tw:alpha*\t4\nbeta\tbeta/beta.v\ttop_beta\t-\t-\t-\t-\t-\t-\t-\t-\t-\n' > %t/manifest.tsv
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nsubcmd="$1"\nshift\nif [[ "$subcmd" != "cover" ]]; then\n  echo "expected cover subcommand" >&2\n  exit 9\nfi\nall_args=("$@")\nwork_dir=""\nwhile [[ $# -gt 0 ]]; do\n  case "$1" in\n    --work-dir) work_dir="$2"; shift 2 ;;\n    --work-dir=*) work_dir="${1#*=}"; shift ;;\n    *) shift ;;\n  esac\ndone\nmkdir -p "$work_dir"\nprintf "%%%%s\\n" "${all_args[@]}" > "$work_dir/args.txt"\nprintf "detected_mutants\\t1\\nrelevant_mutants\\t2\\nerrors\\t0\\n" > "$work_dir/metrics.tsv"\n' > %t/bin/circt-mut
// RUN: chmod +x %t/bin/circt-mut
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nexit 0\n' > %t/bin/yosys
// RUN: chmod +x %t/bin/yosys

// RUN: %S/../../utils/run_mutation_mcy_examples.sh \
// RUN:   --examples-root %t/examples \
// RUN:   --example-manifest %t/manifest.tsv \
// RUN:   --circt-mut %t/bin/circt-mut \
// RUN:   --yosys %t/bin/yosys \
// RUN:   --generate-count 5 \
// RUN:   --mutations-seed 1 \
// RUN:   --mutations-modes control \
// RUN:   --mutation-limit 2 \
// RUN:   --out-dir %t/out

// RUN: FileCheck %s --check-prefix=SUMMARY < %t/out/summary.tsv
// RUN: FileCheck %s --check-prefix=ALPHA < %t/out/alpha/args.txt
// RUN: FileCheck %s --check-prefix=BETA < %t/out/beta/args.txt
// RUN: not grep -q -- '--mutations-profiles' %t/out/beta/args.txt
// RUN: not grep -q -- '--mutations-cfg' %t/out/beta/args.txt
// RUN: not grep -q -- '--mutations-select' %t/out/beta/args.txt

// SUMMARY: example{{[[:space:]]}}status{{[[:space:]]}}exit_code{{[[:space:]]}}detected{{[[:space:]]}}relevant{{[[:space:]]}}coverage_percent{{[[:space:]]}}errors
// SUMMARY: alpha{{[[:space:]]}}PASS{{[[:space:]]}}0{{[[:space:]]}}1{{[[:space:]]}}2{{[[:space:]]}}50.00{{[[:space:]]}}0
// SUMMARY: beta{{[[:space:]]}}PASS{{[[:space:]]}}0{{[[:space:]]}}1{{[[:space:]]}}2{{[[:space:]]}}50.00{{[[:space:]]}}0

// ALPHA: --mutation-limit
// ALPHA: 4
// ALPHA: --generate-mutations
// ALPHA: 9
// ALPHA: --mutations-top
// ALPHA: top_alpha
// ALPHA: --mutations-seed
// ALPHA: 3
// ALPHA: --mutations-modes
// ALPHA: arith
// ALPHA: --mutations-profiles
// ALPHA: fault-basic
// ALPHA: --mutations-cfg
// ALPHA: weight_cover=7
// ALPHA: --mutations-select
// ALPHA: w:alpha*

// BETA: --mutation-limit
// BETA: 2
// BETA: --generate-mutations
// BETA: 5
// BETA: --mutations-top
// BETA: top_beta
// BETA: --mutations-seed
// BETA: 1
// BETA: --mutations-modes
// BETA: control
