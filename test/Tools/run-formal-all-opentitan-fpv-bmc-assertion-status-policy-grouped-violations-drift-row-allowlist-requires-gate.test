// RUN: rm -rf %t
// RUN: mkdir -p %t/utils %t/bin %t/sv-tests %t/verilator %t/yosys %t/ot/hw/top_earlgrey/formal
// RUN: cp %S/../../utils/run_formal_all.sh %t/utils/run_formal_all.sh
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/bin/circt-verilog
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/bin/circt-opt
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/bin/circt-bmc
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/bin/circt-lec
// RUN: printf '{\n  "name": "top_earlgrey_fpv_prim_cfgs",\n  "flow": "formal",\n  "sub_flow": "fpv",\n  "use_cfgs": [\n    {\n      "name": "foo_fpv",\n      "dut": "foo_tb",\n      "fusesoc_core": "lowrisc:fpv:foo_fpv",\n      "task": "FpvDefault",\n      "rel_path": "hw/top_earlgrey/formal/ip/foo"\n    }\n  ]\n}\n' > %t/ot/hw/top_earlgrey/formal/top_earlgrey_fpv_prim_cfgs.hjson
// RUN: printf 'task_profile\trequired_statuses\tforbidden_statuses\nfpv_default\t\tFAILING\n' > %t/presets.tsv
// RUN: printf 'task_profile\tkind\tstatus\ttarget_count\ttargets\tpolicy_sources\nfpv_default\tforbidden_status_present\tFAILING\t0\t\ttask_profile:fpv_default\n' > %t/grouped-baseline.tsv
// RUN: printf 'exact:fpv_default::forbidden_status_present::FAILING::target_count\n' > %t/grouped-row-allowlist.txt
// RUN: chmod +x %t/utils/run_formal_all.sh %t/bin/circt-verilog %t/bin/circt-opt %t/bin/circt-bmc %t/bin/circt-lec
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-opentitan-fpv-bmc --opentitan %t/ot --circt-verilog %t/bin/circt-verilog --include-lane-regex "^opentitan/FPV_BMC$" --opentitan-fpv-cfg %t/ot/hw/top_earlgrey/formal/top_earlgrey_fpv_prim_cfgs.hjson --select-cfgs foo_fpv --opentitan-fpv-bmc-assertion-status-policy-task-profile-presets-file %t/presets.tsv --opentitan-fpv-bmc-assertion-status-policy-grouped-violations-baseline-file %t/grouped-baseline.tsv --opentitan-fpv-bmc-assertion-status-policy-grouped-violations-drift-row-allowlist-file %t/grouped-row-allowlist.txt > %t/err.txt 2>&1'
// RUN: FileCheck %s --check-prefix=ERR < %t/err.txt
//
// ERR: --opentitan-fpv-bmc-assertion-status-policy-grouped-violations-drift-row-allowlist-file requires --fail-on-opentitan-fpv-bmc-assertion-status-policy-grouped-violations-drift or --strict-gate
