// RUN: rm -rf %t && mkdir -p %t/sv-tests/tests/chapter-16 %t/bin %t/repo/lib/Runtime/uvm-core/src
// RUN: bash -eu -c $'cat > %t/sv-tests/tests/chapter-16/16.10--uvm-legacy-path.sv <<\"EOF\"\n/*\n:name: uvm_legacy_path\n:description: verifies LEC harness remaps legacy UVM path to uvm-core/src\n:type: simulation\n:tags: uvm\n:unsynthesizable: 1\n*/\nmodule top;\nendmodule\nEOF\n'
// RUN: bash -eu -c $'cat > %t/bin/circt-verilog <<\"EOF\"\n#!/usr/bin/env bash\nset -euo pipefail\nfound=\"\"\nfor arg in \"$@\"; do\n  case \"$arg\" in\n    --uvm-path=*) found=\"${arg#--uvm-path=}\" ;;\n  esac\ndone\nif [[ \"$found\" != \"${UVM_EXPECT:-}\" ]]; then\n  echo \"unexpected uvm path: $found\" >&2\n  exit 3\nfi\ncat <<\"MLIR\"\nhw.module @top(out out: i1) attributes {num_regs = 0 : i32, initial_values = []} {\n  %true = hw.constant true\n  hw.output %true : i1\n}\nMLIR\nEOF\nchmod +x %t/bin/circt-verilog\n'
// RUN: bash -eu -c $'cat > %t/bin/circt-opt <<\"EOF\"\n#!/usr/bin/env bash\nset -euo pipefail\nin=\"${@: -1}\"\ncat \"$in\"\nEOF\nchmod +x %t/bin/circt-opt\n'
// RUN: bash -eu -c $'cat > %t/bin/circt-lec <<\"EOF\"\n#!/usr/bin/env bash\nexit 0\nEOF\nchmod +x %t/bin/circt-lec\n'
// RUN: env OUT=%t/results.tsv UVM_EXPECT=%t/repo/lib/Runtime/uvm-core/src UVM_PATH=%t/repo/lib/Runtime/uvm CIRCT_VERILOG=%t/bin/circt-verilog CIRCT_OPT=%t/bin/circt-opt CIRCT_LEC=%t/bin/circt-lec LEC_SMOKE_ONLY=1 TAG_REGEX='uvm' TEST_FILTER='uvm-legacy-path' %S/../../utils/run_sv_tests_circt_lec.sh %t/sv-tests | FileCheck %s
// CHECK: sv-tests LEC summary: total=1 pass=1 fail=0 error=0 skip={{[0-9]+}}
