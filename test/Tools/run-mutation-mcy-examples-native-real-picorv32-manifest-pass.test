// RUN: rm -rf %t && mkdir -p %t/examples/picorv32_primes %t/bin
// RUN: printf 'module picorv32(input wire clk, input wire resetn, output wire trap, input wire [7:0] mutsel, input wire [31:0] irq, output wire mem_valid, output wire mem_instr, input wire mem_ready, output wire [31:0] mem_addr, output wire [31:0] mem_wdata, output wire [3:0] mem_wstrb, input wire [31:0] mem_rdata); assign trap = 0; assign mem_valid=0; assign mem_instr=0; assign mem_addr=0; assign mem_wdata=0; assign mem_wstrb=0; endmodule\n' > %t/examples/picorv32_primes/picorv32.v
// RUN: printf 'module testbench; initial begin $display("OK"); $finish; end endmodule\n' > %t/examples/picorv32_primes/sim_simple.v
// RUN: printf '00\n' > %t/examples/picorv32_primes/sim_simple.hex
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nsubcmd="$1"\nshift\nif [[ "$subcmd" != "cover" ]]; then\n  echo "expected cover subcommand" >&2\n  exit 9\nfi\nmanifest=""\nwork_dir=""\nwhile [[ $# -gt 0 ]]; do\n  if [[ "$1" == "--tests-manifest" ]]; then\n    manifest="$2"\n    shift 2\n    continue\n  fi\n  if [[ "$1" == --tests-manifest=* ]]; then\n    manifest="${1#*=}"\n    shift\n    continue\n  fi\n  if [[ "$1" == "--work-dir" ]]; then\n    work_dir="$2"\n    shift 2\n    continue\n  fi\n  if [[ "$1" == --work-dir=* ]]; then\n    work_dir="${1#*=}"\n    shift\n    continue\n  fi\n  shift\ndone\nif [[ -z "$manifest" || -z "$work_dir" ]]; then\n  echo "missing tests manifest/work-dir" >&2\n  exit 8\nfi\nif ! grep -q "real_picorv32_primes_test.sh" "$manifest"; then\n  echo "expected picorv32 real manifest" >&2\n  cat "$manifest" >&2\n  exit 7\nfi\nscript_path="$(cut -f2 "$manifest" | head -n1 | cut -d" " -f2)"\nif [[ ! -f "$script_path" ]]; then\n  echo "missing picorv32 real script" >&2\n  cat "$manifest" >&2\n  exit 6\nfi\nif ! grep -q "sim_simple.good.md5" "$script_path"; then\n  echo "expected baseline hash cache logic" >&2\n  cat "$script_path" >&2\n  exit 5\nfi\nmkdir -p "$work_dir"\nprintf "detected_mutants\\t2\\nrelevant_mutants\\t3\\nerrors\\t0\\n" > "$work_dir/metrics.tsv"\n' > %t/bin/circt-mut
// RUN: chmod +x %t/bin/circt-mut

// RUN: %S/../../utils/run_mutation_mcy_examples.sh \
// RUN:   --examples-root %t/examples \
// RUN:   --example picorv32_primes \
// RUN:   --circt-mut %t/bin/circt-mut \
// RUN:   --mutations-backend native \
// RUN:   --native-tests-mode real \
// RUN:   --out-dir %t/out

// RUN: FileCheck %s --check-prefix=SUMMARY < %t/out/summary.tsv

// SUMMARY: picorv32_primes{{[[:space:]]}}PASS{{[[:space:]]}}0{{[[:space:]]}}2{{[[:space:]]}}3{{[[:space:]]}}66.67{{[[:space:]]}}0
