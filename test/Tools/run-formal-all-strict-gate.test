// RUN: rm -rf %t
// RUN: mkdir -p %t/utils %t/sv-tests %t/verilator %t/yosys %t/opentitan %t/avip/foo_avip
// RUN: cp %S/../../utils/run_formal_all.sh %t/utils/run_formal_all.sh
//
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=9 fail=0 xfail=1 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: printf '#!/usr/bin/env bash\necho "verilator-verification summary: total=10 pass=10 fail=0 xfail=0 xpass=0 error=0 skip=0"\n' > %t/utils/run_verilator_verification_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "verilator-verification LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_verilator_verification_circt_lec.sh
// RUN: printf '#!/usr/bin/env bash\necho "yosys SVA summary: 4 tests, failures=0, xfail=0, xpass=0, skipped=0"\n' > %t/utils/run_yosys_sva_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "yosys LEC summary: total=4 pass=4 fail=0 error=0 skip=0"\n' > %t/utils/run_yosys_sva_circt_lec.sh
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nif [[ \"${CIRCT_VERILOG:-}\" != \"%t/fake-circt-verilog-avip\" ]]; then\n  echo \"bad_CIRCT_VERILOG_AVIP=${CIRCT_VERILOG:-}\"\n  exit 8\nfi\necho \"CIRCT_VERILOG_AVIP_OK\"\n' > %t/utils/run_avip_circt_verilog.sh
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nif [[ \"${CIRCT_VERILOG:-}\" != \"%t/fake-circt-verilog-opentitan\" ]]; then\n  echo \"bad_CIRCT_VERILOG_OPENTITAN=${CIRCT_VERILOG:-}\"\n  exit 9\nfi\necho \"Running LEC on 1 modules\"\necho \"aes_sbox_canright        XPROP_ONLY (accepted)\"\necho \"LEC failures: 0\"\necho \"CIRCT_VERILOG_OPENTITAN_OK\"\n' > %t/utils/run_opentitan_circt_lec.py
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/fake-circt-verilog
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/fake-circt-verilog-avip
// RUN: printf '#!/usr/bin/env bash\nexit 0\n' > %t/fake-circt-verilog-opentitan
// RUN: chmod +x %t/utils/run_formal_all.sh %t/utils/run_sv_tests_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh %t/utils/run_verilator_verification_circt_bmc.sh %t/utils/run_verilator_verification_circt_lec.sh %t/utils/run_yosys_sva_circt_bmc.sh %t/utils/run_yosys_sva_circt_lec.sh %t/utils/run_avip_circt_verilog.sh %t/utils/run_opentitan_circt_lec.py %t/fake-circt-verilog %t/fake-circt-verilog-avip %t/fake-circt-verilog-opentitan
//
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-base --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --baseline-file %t/formal-baselines.tsv --update-baselines --json-summary %t/out-base/summary.json
// RUN: FileCheck %s --check-prefix=JSON < %t/out-base/summary.json
// RUN: FileCheck %s --check-prefix=BASELINE < %t/formal-baselines.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-avip --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-avip --avip-glob %t/avip/* --with-opentitan --opentitan %t/opentitan --circt-verilog %t/fake-circt-verilog --circt-verilog-avip %t/fake-circt-verilog-avip --circt-verilog-opentitan %t/fake-circt-verilog-opentitan
// RUN: FileCheck %s --check-prefix=AVIPPATH < %t/out-avip/summary.tsv
// RUN: FileCheck %s --check-prefix=AVIPENV < %t/out-avip/avip-foo_avip.log
// RUN: FileCheck %s --check-prefix=OPENTITANPATH < %t/out-avip/summary.tsv
// RUN: FileCheck %s --check-prefix=OPENTITANENV < %t/out-avip/opentitan-lec.log
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-include --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-opentitan --opentitan %t/opentitan --with-avip --avip-glob %t/avip/* --circt-verilog %t/fake-circt-verilog --circt-verilog-avip %t/fake-circt-verilog-avip --circt-verilog-opentitan %t/fake-circt-verilog-opentitan --include-lane-regex '^sv-tests/(BMC|LEC)$'
// RUN: FileCheck %s --check-prefix=LANEINCLUDE < %t/out-lane-include/summary.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-exclude --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-opentitan --opentitan %t/opentitan --with-avip --avip-glob %t/avip/* --circt-verilog %t/fake-circt-verilog --circt-verilog-avip %t/fake-circt-verilog-avip --circt-verilog-opentitan %t/fake-circt-verilog-opentitan --include-lane-regex '^sv-tests/' --exclude-lane-regex '/LEC$'
// RUN: FileCheck %s --check-prefix=LANEEXCLUDE < %t/out-lane-exclude/summary.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --include-lane-regex '^sv-tests/(BMC|LEC)$'
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=1 fail=9 xfail=0 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_bmc.sh
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --resume-from-lane-state --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANERESUME < %t/out-lane-state-resume/summary.tsv
// RUN: test ! -e %t/out-lane-state-resume/sv-tests-bmc.log
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-reset --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --reset-lane-state --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANERESET < %t/out-lane-state-reset/summary.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-bad-flags --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --resume-from-lane-state --reset-lane-state --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEBADFLAGS
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyid-no-file --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-hmac-key-id lane-key-1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYIDNOFILE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-key-file-no-state --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-hmac-key-file %t/not-used.key --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYFILENOSTATE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-no-state --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-hmac-keyring-tsv %t/not-used.tsv --lane-state-hmac-key-id lane-key-1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGNOSTATE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-sha-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-hmac-keyring-sha256 0000000000000000000000000000000000000000000000000000000000000000 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGSHANORING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-key-source-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-hmac-key-file %t/not-used.key --lane-state-hmac-keyring-tsv %t/not-used.tsv --lane-state-hmac-key-id lane-key-1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYSOURCECONFLICT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-private-no-public --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-manifest-ed25519-private-key-file %t/not-used-ed25519-private.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519PRIVATEONLY
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-public-no-private --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-manifest-ed25519-public-key-file %t/not-used-ed25519-public.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519PUBLICONLY
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-no-private --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-manifest-ed25519-keyring-tsv %t/not-used-ed25519-keyring.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGNOPRIVATE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-sha-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-keyring-sha256 0000000000000000000000000000000000000000000000000000000000000000 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGSHANORING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ca-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ca-file %t/not-used-ed25519-ca.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CANORING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-file %t/not-used-ed25519.crl.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLNORING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-no-ca --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-manifest-ed25519-keyring-tsv %t/not-used-ed25519-keyring.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --lane-state-manifest-ed25519-crl-file %t/not-used-ed25519.crl.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLNOCA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-no-crl --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-cmd "true" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHNOCRL
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-uri-no-crl --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-uri "file://%t/lane-state-ed25519.crl.pem" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHURINOCRL
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-auto-uri-no-crl --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHAUTOURINOCRL
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-auto-uri-policy-no-mode --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy last --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLAUTOPOLICYNOMODE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-auto-uri-policy-invalid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-auto-uri-policy invalid --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOPOLICYINVALID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-auto-uri-allowed-schemes-invalid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-auto-uri-allowed-schemes ftp --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOSCHEMESINVALID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-profile-no-json --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profile strict --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOPROFILENOJSON
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-json-no-profile --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/missing-refresh-policies.json --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOJSONNOPROFILE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-json-sha-no-json --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOJSONSHANOJSON
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-json-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/missing-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile strict --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 xyz --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOJSONSHABAD
// RUN: printf '{"schema_version":1,"profiles":{"strict":{"auto_uri_policy":"last","auto_uri_allowed_schemes":"https"}}}\n' > %t/not-used-refresh-policies.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-no-json --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/missing-refresh-policies.manifest.json --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTNOJSON
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-pubkey-no-manifest --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/not-used-ed25519-public.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTPUBKEYNOMANIFEST
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-keyring-no-manifest --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/not-used-ed25519-keyring.tsv --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTKEYRINGNOMANIFEST
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-keyring-sha-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-sha256 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTKEYRINGSHANOKEYRING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-keyring-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/not-used-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile strict --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/missing-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/not-used-ed25519-keyring.tsv --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-sha256 xyz --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTKEYRINGSHABAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-pubkey-keyring-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/not-used-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile strict --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/missing-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/not-used-ed25519-public.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/not-used-ed25519-keyring.tsv --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTPUBKEYKEYRINGCONFLICT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-keyring-ca-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-ca-file %t/not-used-ed25519-ca.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTKEYRINGCANOKEYRING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-keyid-no-manifest --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTKEYIDNOMANIFEST
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-manifest-no-pubkey --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/not-used-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile strict --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/missing-refresh-policies.manifest.json --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOMANIFESTNOPUBKEY
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-auto-uri-allowed-schemes-no-mode --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-auto-uri-allowed-schemes file --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLAUTOSCHEMESNOMODE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-retries-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-retries 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHRETRIESNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-delay-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-delay-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHDELAYNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-timeout-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-timeout-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHTIMEOUTNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-jitter-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-jitter-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHJITTERNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-metadata-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/not-used-crl-meta.json --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHMETADATANOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-meta-transport-no-meta --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport https --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHMETADATATRANSPORTNOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-crl-refresh-meta-maxage-no-meta --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-crl-refresh-metadata-max-age-secs 60 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519CRLREFRESHMETADATAMAXAGENOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-response-file %t/not-used-ed25519.ocsp.der --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPNORING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-no-ca --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --lane-state-manifest-ed25519-keyring-tsv %t/not-used-ed25519-keyring.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --lane-state-manifest-ed25519-ocsp-response-file %t/not-used-ed25519.ocsp.der --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPNOCA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-cmd "true" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHNORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-uri-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-uri "file://%t/lane-state-ed25519-good.ocsp.der" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHURINORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-auto-uri-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHAUTOURINORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-auto-uri-policy-no-mode --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-policy last --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPAUTOPOLICYNOMODE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-auto-uri-allowed-schemes-no-mode --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-allowed-schemes file --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPAUTOSCHEMESNOMODE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-retries-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-retries 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHRETRIESNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-delay-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-delay-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHDELAYNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-timeout-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-timeout-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHTIMEOUTNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-jitter-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-jitter-secs 1 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHJITTERNOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-metadata-no-cmd --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/not-used-ocsp-meta.json --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHMETADATANOCMD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-meta-status-no-meta --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHMETADATASTATUSNOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-refresh-meta-futureskew-no-meta --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-refresh-metadata-max-future-skew-secs 0 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPREFRESHMETADATAFUTURESKEWNOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-sha-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-response-sha256 0000000000000000000000000000000000000000000000000000000000000000 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPSHANORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-responder-cert-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-responder-cert-file %t/not-used-ed25519-responder-cert.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPRESPCERTNORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-issuer-cert-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-issuer-cert-file %t/not-used-ed25519-issuer-cert.pem --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPISSUERCERTNORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-responder-cert-sha-no-cert --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-responder-cert-sha256 0000000000000000000000000000000000000000000000000000000000000000 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPRESPCERTSHANOCERT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-responder-require-eku-no-cert --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-require-responder-ocsp-signing --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPRESPREQUIREEKUNOCERT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-responder-require-aki-no-cert --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-require-responder-aki-match-ca-ski --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPRESPREQUIREAKINOCERT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-max-age-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-max-age-secs 10 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPMAXAGENORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-nextupdate-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-require-next-update --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPNUNORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-ocsp-responder-no-resp --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-ocsp-responder-id-regex "lane-state-ed25519" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519OCSPRESPIDNORESP
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-subject-no-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-cert-subject-regex "CN=lane-state-ed25519" --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519SUBJECTNORING
// RUN: awk -F'\t' 'BEGIN{OFS="\t"} NR==1{print; next} {$12="2"; print}' %t/lane-state.tsv > %t/lane-state-bad-policy.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-bad-policy --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-bad-policy.tsv --resume-from-lane-state --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEBADPOLICY
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-bad-hash --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state.tsv --resume-from-lane-state --bmc-assume-known-inputs --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEBADHASH
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=9 fail=0 xfail=1 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-merge-a --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-a.tsv --reset-lane-state --include-lane-regex '^sv-tests/BMC$'
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-merge-b --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-b.tsv --reset-lane-state --include-lane-regex '^sv-tests/LEC$'
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-merge-build --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-merged.tsv --reset-lane-state --merge-lane-state-tsv %t/lane-state-a.tsv --merge-lane-state-tsv %t/lane-state-b.tsv --include-lane-regex '^$'
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=1 fail=9 xfail=0 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=0 fail=10 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-merge-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-merged.tsv --resume-from-lane-state --include-lane-regex '^sv-tests/(BMC|LEC)$'
// RUN: FileCheck %s --check-prefix=LANEMERGERESUME < %t/out-lane-state-merge-resume/summary.tsv
// RUN: test ! -e %t/out-lane-state-merge-resume/sv-tests-bmc.log
// RUN: test ! -e %t/out-lane-state-merge-resume/sv-tests-lec.log
// RUN: cp %t/lane-state-a.tsv %t/lane-state-a-bad.tsv
// RUN: sed -i '2s/[0-9a-f]\{64\}$/0000000000000000000000000000000000000000000000000000000000000000/' %t/lane-state-a-bad.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-merge-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-merge-conflict.tsv --reset-lane-state --merge-lane-state-tsv %t/lane-state-a.tsv --merge-lane-state-tsv %t/lane-state-a-bad.tsv --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANEMERGECONFLICT
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=9 fail=0 xfail=1 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh
// RUN: printf 'lane-state-test-key\n' > %t/lane-state-hmac.key
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --reset-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEMANIFEST < %t/lane-state-signed.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --resume-from-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATESIGNEDRESUME < %t/out-lane-state-signed-resume/summary.tsv
// RUN: awk -F'\t' 'BEGIN{OFS="\t"} NR==1{print; next} {$5="8"; $6="1"; print}' %t/lane-state-signed.tsv > %t/lane-state-signed-bad.tsv
// RUN: mv %t/lane-state-signed-bad.tsv %t/lane-state-signed.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-bad-sha --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --resume-from-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEBADSHA
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-reseed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --reset-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-bad-keyid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --resume-from-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-2 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEBADKEYID
// RUN: rm -f %t/lane-state-signed.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-signed-missing-manifest --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-signed.tsv --resume-from-lane-state --lane-state-hmac-key-file %t/lane-state-hmac.key --lane-state-hmac-key-id lane-key-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEMISSINGMANIFEST
// RUN: openssl genpkey -algorithm ed25519 -out %t/lane-state-ed25519-private.pem
// RUN: openssl pkey -in %t/lane-state-ed25519-private.pem -pubout -out %t/lane-state-ed25519-public.pem
// RUN: openssl req -x509 -new -key %t/lane-state-ed25519-private.pem -subj "/CN=lane-state-ed25519" -days 36500 -addext "crlDistributionPoints=URI:file://%t/lane-state-ed25519.crl.pem,URI:file://%t/lane-state-ed25519-alt.crl.pem" -addext "authorityInfoAccess=OCSP;URI:file://%t/lane-state-ed25519-good.ocsp.der,OCSP;URI:file://%t/lane-state-ed25519-alt.ocsp.der" -out %t/lane-state-ed25519-cert.pem
// RUN: PUB_SHA=$(sha256sum %t/lane-state-ed25519-public.pem | cut -d' ' -f1) && CERT_SHA=$(sha256sum %t/lane-state-ed25519-cert.pem | cut -d' ' -f1) && printf "lane-ed25519-1\t%t/lane-state-ed25519-public.pem\t\t\tactive\t${PUB_SHA}\t%t/lane-state-ed25519-cert.pem\t${CERT_SHA}\n" > %t/lane-state-ed25519-keyring.tsv
// RUN: mkdir -p %t/ed25519-ca/newcerts
// RUN: : > %t/ed25519-ca/index.txt
// RUN: echo 1000 > %t/ed25519-ca/serial
// RUN: echo 1000 > %t/ed25519-ca/crlnumber
// RUN: printf '[ ca ]\ndefault_ca = CA_default\n[ CA_default ]\ndir = %t/ed25519-ca\ncertificate = %t/lane-state-ed25519-cert.pem\nprivate_key = %t/lane-state-ed25519-private.pem\ndatabase = %t/ed25519-ca/index.txt\nnew_certs_dir = %t/ed25519-ca/newcerts\nserial = %t/ed25519-ca/serial\ncrlnumber = %t/ed25519-ca/crlnumber\ndefault_crl_days = 365\ndefault_md = sha256\npolicy = policy_any\nx509_extensions = usr_cert\n[ policy_any ]\ncommonName = supplied\n[ usr_cert ]\nbasicConstraints = CA:FALSE\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid,issuer\n' > %t/ed25519-ca/openssl.cnf
// RUN: openssl ca -config %t/ed25519-ca/openssl.cnf -gencrl -out %t/lane-state-ed25519.crl.pem -batch
// RUN: openssl ca -config %t/ed25519-ca/openssl.cnf -gencrl -crl_lastupdate 20200101000000Z -crl_nextupdate 20200102000000Z -out %t/lane-state-ed25519-stale.crl.pem -batch
// RUN: openssl ca -config %t/ed25519-ca/openssl.cnf -valid %t/lane-state-ed25519-cert.pem -batch
// RUN: openssl ocsp -index %t/ed25519-ca/index.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -respout %t/lane-state-ed25519-good.ocsp.der
// RUN: cp %t/lane-state-ed25519.crl.pem %t/lane-state-ed25519-alt.crl.pem
// RUN: cp %t/lane-state-ed25519-good.ocsp.der %t/lane-state-ed25519-alt.ocsp.der
// RUN: cp %t/ed25519-ca/index.txt %t/ed25519-ca/index.pre-revoke.txt
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nopenssl ocsp -index %t/ed25519-ca/index.pre-revoke.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -respout %t/lane-state-ed25519-good.ocsp.der >/dev/null 2>&1\n' > %t/lane-state-ed25519-refresh-ocsp.sh
// RUN: chmod +x %t/lane-state-ed25519-refresh-ocsp.sh
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\ntest -r %t/lane-state-ed25519.crl.pem\n' > %t/lane-state-ed25519-refresh-crl.sh
// RUN: chmod +x %t/lane-state-ed25519-refresh-crl.sh
// RUN: printf '{"schema_version":1,"source":"lit-crl-refresh","transport":"file","uri":"file://%t/lane-state-ed25519.crl.pem","fetched_at_utc":"2099-01-01T00:00:00Z","status":"ok"}\n' > %t/lane-state-ed25519-refresh-crl.metadata.json
// RUN: printf '{"schema_version":1,"source":"lit-ocsp-refresh","transport":"https","uri":"https://ocsp.example.test","fetched_at_utc":"2099-01-01T00:00:00Z","status":"ok","http_status":200,"tls_peer_sha256":"1111111111111111111111111111111111111111111111111111111111111111","cert_chain_sha256":["2222222222222222222222222222222222222222222222222222222222222222"]}\n' > %t/lane-state-ed25519-refresh-ocsp.metadata.json
// RUN: printf '{"schema_version":1,"source":"lit-ocsp-refresh-bad","transport":"https","uri":"https://ocsp.example.test","fetched_at_utc":"2099-01-01T00:00:00Z","status":"ok","http_status":200}\n' > %t/lane-state-ed25519-refresh-ocsp.bad-https-metadata.json
// RUN: printf '{"schema_version":2,"source":"bad-meta","transport":"file","uri":"file://%t/lane-state-ed25519.crl.pem","fetched_at_utc":"2099-01-01T00:00:00Z","status":"ok"}\n' > %t/lane-state-ed25519-refresh-crl.bad-metadata.json
// RUN: printf '{"schema_version":1,"source":"lit-crl-refresh-stale","transport":"file","uri":"file://%t/lane-state-ed25519.crl.pem","fetched_at_utc":"1970-01-01T00:00:00Z","status":"ok"}\n' > %t/lane-state-ed25519-refresh-crl.stale-metadata.json
// RUN: printf '{"schema_version":1,"profiles":{"shared_last":{"auto_uri_policy":"last","auto_uri_allowed_schemes":"file"},"shared_first":{"auto_uri_policy":"first","auto_uri_allowed_schemes":"file"}}}\n' > %t/lane-state-ed25519-refresh-policies.json
// RUN: python3 -c "import base64,hashlib,json,pathlib,subprocess; t=pathlib.Path(r'%t'); profiles=t/'lane-state-ed25519-refresh-policies.json'; private_key=t/'lane-state-ed25519-private.pem'; payload={'schema_version':1,'generated_at_utc':'1970-01-01T00:00:00Z','profiles_sha256':hashlib.sha256(profiles.read_bytes()).hexdigest(),'signature_mode':'ed25519','key_id':'profile-key-1'}; canon=json.dumps(payload,sort_keys=True,separators=(',',':')).encode('utf-8'); (t/'refresh-policy-profiles.payload.json').write_bytes(canon); subprocess.run(['openssl','pkeyutl','-sign','-inkey',str(private_key),'-rawin','-in',str(t/'refresh-policy-profiles.payload.json'),'-out',str(t/'refresh-policy-profiles.signature.bin')],check=True,stdout=subprocess.DEVNULL,stderr=subprocess.DEVNULL); payload['signature_ed25519_base64']=base64.b64encode((t/'refresh-policy-profiles.signature.bin').read_bytes()).decode('ascii'); (t/'lane-state-ed25519-refresh-policies.manifest.json').write_text(json.dumps(payload,sort_keys=True),encoding='utf-8')"
// RUN: python3 -c "import base64,hashlib,json,pathlib,subprocess; t=pathlib.Path(r'%t'); profiles=t/'lane-state-ed25519-refresh-policies.json'; private_key=t/'lane-state-ed25519-private.pem'; payload={'schema_version':1,'generated_at_utc':'1970-01-01T00:00:00Z','profiles_sha256':hashlib.sha256(profiles.read_bytes()).hexdigest(),'signature_mode':'ed25519'}; canon=json.dumps(payload,sort_keys=True,separators=(',',':')).encode('utf-8'); (t/'refresh-policy-profiles-no-key-id.payload.json').write_bytes(canon); subprocess.run(['openssl','pkeyutl','-sign','-inkey',str(private_key),'-rawin','-in',str(t/'refresh-policy-profiles-no-key-id.payload.json'),'-out',str(t/'refresh-policy-profiles-no-key-id.signature.bin')],check=True,stdout=subprocess.DEVNULL,stderr=subprocess.DEVNULL); payload['signature_ed25519_base64']=base64.b64encode((t/'refresh-policy-profiles-no-key-id.signature.bin').read_bytes()).decode('ascii'); (t/'lane-state-ed25519-refresh-policies.manifest-no-key-id.json').write_text(json.dumps(payload,sort_keys=True),encoding='utf-8')"
// RUN: printf 'profile-key-1\t%t/lane-state-ed25519-public.pem\t1970-01-01\t2099-12-31\tactive\nprofile-key-revoked\t%t/lane-state-ed25519-public.pem\t1970-01-01\t2099-12-31\trevoked\n' > %t/lane-state-ed25519-refresh-policy-manifest-keyring.tsv
// RUN: PUB_SHA=$(sha256sum %t/lane-state-ed25519-public.pem | cut -d' ' -f1) && CERT_SHA=$(sha256sum %t/lane-state-ed25519-cert.pem | cut -d' ' -f1) && printf "profile-key-1\t%t/lane-state-ed25519-public.pem\t1970-01-01\t2099-12-31\tactive\t${PUB_SHA}\t%t/lane-state-ed25519-cert.pem\t${CERT_SHA}\nprofile-key-revoked\t%t/lane-state-ed25519-public.pem\t1970-01-01\t2099-12-31\trevoked\t${PUB_SHA}\t%t/lane-state-ed25519-cert.pem\t${CERT_SHA}\n" > %t/lane-state-ed25519-refresh-policy-manifest-keyring-cert.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-refresh-json-sha-mismatch --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 0000000000000000000000000000000000000000000000000000000000000000 --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519AUTOJSONSHAMISMATCH
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\ncount_file=%t/lane-state-ed25519-refresh-ocsp.count\ncount=0\nif [[ -r \"$count_file\" ]]; then\n  count=$(cat \"$count_file\")\nfi\ncount=$((count + 1))\necho \"$count\" > \"$count_file\"\nif [[ \"$count\" -lt 2 ]]; then\n  exit 1\nfi\nopenssl ocsp -index %t/ed25519-ca/index.pre-revoke.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -respout %t/lane-state-ed25519-good.ocsp.der >/dev/null 2>&1\n' > %t/lane-state-ed25519-refresh-ocsp-flaky.sh
// RUN: chmod +x %t/lane-state-ed25519-refresh-ocsp-flaky.sh
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\ncount_file=%t/lane-state-ed25519-refresh-ocsp-timeout.count\ncount=0\nif [[ -r \"$count_file\" ]]; then\n  count=$(cat \"$count_file\")\nfi\ncount=$((count + 1))\necho \"$count\" > \"$count_file\"\nif [[ \"$count\" -lt 2 ]]; then\n  sleep 2\nfi\nopenssl ocsp -index %t/ed25519-ca/index.pre-revoke.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -respout %t/lane-state-ed25519-good.ocsp.der >/dev/null 2>&1\n' > %t/lane-state-ed25519-refresh-ocsp-timeout.sh
// RUN: chmod +x %t/lane-state-ed25519-refresh-ocsp-timeout.sh
// RUN: openssl ocsp -index %t/ed25519-ca/index.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -nmin 10 -respout %t/lane-state-ed25519-nextupdate.ocsp.der
// RUN: openssl genpkey -algorithm ed25519 -out %t/lane-state-ed25519-ocsp-responder-private.pem
// RUN: openssl req -new -key %t/lane-state-ed25519-ocsp-responder-private.pem -subj "/CN=lane-state-ed25519-ocsp-responder" -out %t/lane-state-ed25519-ocsp-responder.csr
// RUN: printf 'basicConstraints=critical,CA:FALSE\nkeyUsage=digitalSignature\nextendedKeyUsage=OCSPSigning\nsubjectKeyIdentifier=hash\nauthorityKeyIdentifier=keyid,issuer\n' > %t/lane-state-ed25519-ocsp-responder-ext.cnf
// RUN: openssl x509 -req -in %t/lane-state-ed25519-ocsp-responder.csr -CA %t/lane-state-ed25519-cert.pem -CAkey %t/lane-state-ed25519-private.pem -CAcreateserial -days 36500 -extfile %t/lane-state-ed25519-ocsp-responder-ext.cnf -out %t/lane-state-ed25519-ocsp-responder-cert.pem
// RUN: openssl ocsp -index %t/ed25519-ca/index.txt -rsigner %t/lane-state-ed25519-ocsp-responder-cert.pem -rkey %t/lane-state-ed25519-ocsp-responder-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -nmin 10 -respout %t/lane-state-ed25519-responder-eku-nextupdate.ocsp.der
// RUN: openssl ca -config %t/ed25519-ca/openssl.cnf -revoke %t/lane-state-ed25519-cert.pem -batch
// RUN: openssl ca -config %t/ed25519-ca/openssl.cnf -gencrl -out %t/lane-state-ed25519-revoked.crl.pem -batch
// RUN: openssl ocsp -index %t/ed25519-ca/index.txt -rsigner %t/lane-state-ed25519-cert.pem -rkey %t/lane-state-ed25519-private.pem -CA %t/lane-state-ed25519-cert.pem -issuer %t/lane-state-ed25519-cert.pem -cert %t/lane-state-ed25519-cert.pem -respout %t/lane-state-ed25519-revoked.ocsp.der
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-no-keyid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-no-keyid.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGNOID
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519MANIFEST < %t/lane-state-ed25519.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519.tsv --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519RESUME < %t/out-lane-state-ed25519-resume/summary.tsv
// RUN: openssl genpkey -algorithm ed25519 -out %t/lane-state-ed25519-wrong-private.pem
// RUN: openssl pkey -in %t/lane-state-ed25519-wrong-private.pem -pubout -out %t/lane-state-ed25519-wrong-public.pem
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-bad-pub --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519.tsv --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-public-key-file %t/lane-state-ed25519-wrong-public.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519BADSIG
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-bad-keyid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519.tsv --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-key-id wrong-ed25519 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519BADKEYID
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring.tsv.state --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGMANIFEST < %t/lane-state-ed25519-keyring.tsv.state.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring.tsv.state --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGRESUME < %t/out-lane-state-ed25519-keyring-resume/summary.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAMANIFEST < %t/lane-state-ed25519-keyring-ca.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca.tsv --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCARESUME < %t/out-lane-state-ed25519-keyring-ca-resume/summary.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-subject-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-subject.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-cert-subject-regex 'CN=lane-state-ed25519' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCASUBJECT < %t/lane-state-ed25519-keyring-ca-subject.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-cmd %t/lane-state-ed25519-refresh-crl.sh --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRL < %t/lane-state-ed25519-keyring-ca-crl.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-uri --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-uri.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-uri file://%t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.uri.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLURI < %t/lane-state-ed25519-keyring-ca-crl-uri.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURI < %t/lane-state-ed25519-keyring-ca-crl-auto-uri.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-last --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-last.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-auto-uri-policy last --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.last.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519-alt\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURILAST < %t/lane-state-ed25519-keyring-ca-crl-auto-uri-last.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 $(sha256sum %t/lane-state-ed25519-refresh-policies.json | awk '{print $1}') --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519-alt\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST < %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last-keyring --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last-keyring.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 $(sha256sum %t/lane-state-ed25519-refresh-policies.json | awk '{print $1}') --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/lane-state-ed25519-refresh-policy-manifest-keyring-cert.tsv --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-sha256 $(sha256sum %t/lane-state-ed25519-refresh-policy-manifest-keyring-cert.tsv | awk '{print $1}') --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519-alt\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING < %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-last-keyring.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-bad-sig --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-bad-sig.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/lane-state-ed25519-wrong-public.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAAUTOMANIFESTBADSIG
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-bad-keyid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-bad-keyid.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id wrong-profile-key --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAAUTOMANIFESTBADKEYID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-keyring-no-cert --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-keyring-no-cert.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/lane-state-ed25519-refresh-policy-manifest-keyring.tsv --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAAUTOMANIFESTKEYRINGNOCERT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-keyring-missing-keyid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-manifest-keyring-missing-keyid.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest-no-key-id.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv %t/lane-state-ed25519-refresh-policy-manifest-keyring.tsv --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-last.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAAUTOMANIFESTKEYRINGNOKEYID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-profile-unknown --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-profile-unknown.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile missing --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.profile-unknown.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAAUTOPROFILEUNKNOWN
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-schemes-shared-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-schemes-shared-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-auto-uri-allowed-schemes https --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.schemes-shared-bad.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESSHAREDBAD
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-schemes-override --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-schemes-override.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-auto-uri-allowed-schemes https --lane-state-manifest-ed25519-crl-refresh-auto-uri-allowed-schemes file --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.schemes-override.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE < %t/lane-state-ed25519-keyring-ca-crl-auto-uri-schemes-override.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-policy-override --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-policy-override.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-refresh-auto-uri-policy last --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy first --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.override.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport file --lane-state-manifest-ed25519-crl-refresh-metadata-require-status ok --lane-state-manifest-ed25519-crl-refresh-metadata-require-uri-regex 'lane-state-ed25519\.crl\.pem$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE < %t/lane-state-ed25519-keyring-ca-crl-auto-uri-policy-override.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-single-policy-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-single-policy-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy require_single --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.single-policy-bad.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIREQUIRESINGLEBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-policy-invalid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-policy-invalid.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy invalid --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.invalid-policy.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIPOLICYINVALID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-uri-no-metadata --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-uri-no-metadata.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-uri file://%t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLURINOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-no-metadata --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-no-metadata.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURINOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-refresh-mode-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-refresh-mode-conflict.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-cmd %t/lane-state-ed25519-refresh-crl.sh --lane-state-manifest-ed25519-crl-refresh-uri file://%t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLMODECONFLICT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-auto-uri-mode-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-auto-uri-mode-conflict.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-uri file://%t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.auto.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLAUTOURIMODECONFLICT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-bad-metadata --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-bad-metadata.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-cmd %t/lane-state-ed25519-refresh-crl.sh --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.bad-metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLBADMETADATA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-policy-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-policy-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-cmd %t/lane-state-ed25519-refresh-crl.sh --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport https --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLMETADATAPOLICYBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-metadata-stale --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-metadata-stale.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519.crl.pem --lane-state-manifest-ed25519-crl-refresh-cmd %t/lane-state-ed25519-refresh-crl.sh --lane-state-manifest-ed25519-crl-refresh-metadata-file %t/lane-state-ed25519-refresh-crl.stale-metadata.json --lane-state-manifest-ed25519-crl-refresh-metadata-max-age-secs 3600 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLMETADATASTALE
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSP < %t/lane-state-ed25519-keyring-ca-ocsp.tsv.manifest.json
// RUN: not sh -c 'cd %t && sleep 2 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-stale --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-stale.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 1 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPSTALE
// RUN: cd %t && sleep 3 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 2 --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp.sh --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-transport https --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-uri-regex '^https://ocsp\.example\.test$' --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-tls-peer-sha256 1111111111111111111111111111111111111111111111111111111111111111 --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-cert-chain-sha256 2222222222222222222222222222222222222222222222222222222222222222 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESH < %t/lane-state-ed25519-keyring-ca-ocsp-refresh.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-uri --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-uri.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-uri file://%t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.uri.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-transport file --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-uri-regex 'lane-state-ed25519-good\.ocsp\.der$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHURI < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-uri.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-transport file --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-uri-regex 'lane-state-ed25519-good\.ocsp\.der$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-last --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-last.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-refresh-auto-uri-policy last --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.last.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-transport file --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-uri-regex 'lane-state-ed25519-alt\.ocsp\.der$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-last.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-profile-last --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-profile-last.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-refresh-policy-profiles-json %t/lane-state-ed25519-refresh-policies.json --lane-state-manifest-ed25519-refresh-policy-profile shared_last --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 $(sha256sum %t/lane-state-ed25519-refresh-policies.json | awk '{print $1}') --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json %t/lane-state-ed25519-refresh-policies.manifest.json --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file %t/lane-state-ed25519-public.pem --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id profile-key-1 --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.profile-last.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-transport file --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status ok --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-uri-regex 'lane-state-ed25519-alt\.ocsp\.der$' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-profile-last.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-single-policy-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-single-policy-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-policy require_single --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.single-policy-bad.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPAUTOURIREQUIRESINGLEBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-policy-invalid --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-policy-invalid.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-policy invalid --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.invalid-policy.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPAUTOURIPOLICYINVALID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-mode-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-mode-conflict.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp.sh --lane-state-manifest-ed25519-ocsp-refresh-uri file://%t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPMODECONFLICT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-no-metadata --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-no-metadata.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPAUTOURINOMETA
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-mode-conflict --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-auto-uri-mode-conflict.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-uri file://%t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.auto.metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPAUTOURIMODECONFLICT
// RUN: not sh -c 'cd %t && sleep 3 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-bad-https-metadata --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-bad-https-metadata.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 2 --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp.sh --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.bad-https-metadata.json --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHBADHTTPSMETADATA
// RUN: not sh -c 'cd %t && sleep 3 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-future-skew --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-future-skew.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 2 --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp.sh --lane-state-manifest-ed25519-ocsp-refresh-metadata-file %t/lane-state-ed25519-refresh-ocsp.metadata.json --lane-state-manifest-ed25519-ocsp-refresh-metadata-max-future-skew-secs 0 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPREFRESHFUTURESKEWBAD
// RUN: cd %t && rm -f %t/lane-state-ed25519-refresh-ocsp.count && sleep 3 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-retry --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-retry.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 2 --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp-flaky.sh --lane-state-manifest-ed25519-ocsp-refresh-retries 1 --lane-state-manifest-ed25519-ocsp-refresh-delay-secs 0 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: test "$(cat %t/lane-state-ed25519-refresh-ocsp.count)" = "2"
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRETRY < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-retry.tsv.manifest.json
// RUN: cd %t && rm -f %t/lane-state-ed25519-refresh-ocsp-timeout.count && sleep 3 && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-refresh-timeout-retry --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-refresh-timeout-retry.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-max-age-secs 2 --lane-state-manifest-ed25519-ocsp-refresh-cmd %t/lane-state-ed25519-refresh-ocsp-timeout.sh --lane-state-manifest-ed25519-ocsp-refresh-retries 1 --lane-state-manifest-ed25519-ocsp-refresh-delay-secs 0 --lane-state-manifest-ed25519-ocsp-refresh-timeout-secs 1 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: test "$(cat %t/lane-state-ed25519-refresh-ocsp-timeout.count)" = "2"
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPTIMEOUTRETRY < %t/lane-state-ed25519-keyring-ca-ocsp-refresh-timeout-retry.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-nextupdate-missing --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-nextupdate-missing.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-require-next-update --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPNEXTUPDATEMISSING
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-sha-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-good.ocsp.der --lane-state-manifest-ed25519-ocsp-response-sha256 0000000000000000000000000000000000000000000000000000000000000000 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPSHABAD
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-nextupdate-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-nextupdate.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-require-next-update --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPNEXTUPDATE < %t/lane-state-ed25519-keyring-ca-ocsp-nextupdate.tsv.manifest.json
// RUN: cd %t && RESP_CERT_SHA=$(sha256sum %t/lane-state-ed25519-cert.pem | cut -d' ' -f1) && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-cert-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-responder-cert-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-responder-cert-sha256 "$RESP_CERT_SHA" --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPCERT < %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert.tsv.manifest.json
// RUN: cd %t && RESP_EKU_CERT_SHA=$(sha256sum %t/lane-state-ed25519-ocsp-responder-cert.pem | cut -d' ' -f1) && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-cert-eku-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert-eku.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-responder-eku-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-issuer-cert-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-responder-cert-file %t/lane-state-ed25519-ocsp-responder-cert.pem --lane-state-manifest-ed25519-ocsp-responder-cert-sha256 "$RESP_EKU_CERT_SHA" --lane-state-manifest-ed25519-ocsp-require-responder-ocsp-signing --lane-state-manifest-ed25519-ocsp-require-responder-aki-match-ca-ski --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPCERTEKU < %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert-eku.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-cert-eku-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert-eku-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-responder-cert-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-require-responder-ocsp-signing --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPCERTEKUBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-cert-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder-cert-sha-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-responder-cert-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-responder-cert-sha256 0000000000000000000000000000000000000000000000000000000000000000 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPCERTSHABAD
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-responder-id-regex 'lane-state-ed25519' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPID < %t/lane-state-ed25519-keyring-ca-ocsp-responder.tsv.manifest.json
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-responder-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-responder-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-nextupdate.ocsp.der --lane-state-manifest-ed25519-ocsp-responder-id-regex 'does-not-match' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPRESPIDBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring.tsv.state --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-keyring-sha256 0000000000000000000000000000000000000000000000000000000000000000 --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGSHABAD
// RUN: PUB_SHA=$(sha256sum %t/lane-state-ed25519-public.pem | cut -d' ' -f1) && printf "lane-ed25519-1\t%t/lane-state-ed25519-public.pem\t\t\tactive\t${PUB_SHA}\n" > %t/lane-state-ed25519-keyring-nocert.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-nocert --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-nocert.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring-nocert.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCANOCERT
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-stale --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-stale.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519-stale.crl.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLSTALE
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-crl-revoked --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-crl-revoked.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-crl-file %t/lane-state-ed25519-revoked.crl.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCACRLBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-ocsp-revoked --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-ocsp-revoked.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-ocsp-response-file %t/lane-state-ed25519-revoked.ocsp.der --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCAOCSPBAD
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-bad-subject --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca-subject-bad.tsv --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-cert.pem --lane-state-manifest-ed25519-cert-subject-regex 'CN=does-not-match' --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCASUBJECTBAD
// RUN: openssl req -x509 -new -key %t/lane-state-ed25519-wrong-private.pem -subj "/CN=lane-state-ed25519-wrong-ca" -days 36500 -out %t/lane-state-ed25519-wrong-ca.pem
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-ca-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-ca.tsv --resume-from-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring.tsv --lane-state-manifest-ed25519-ca-file %t/lane-state-ed25519-wrong-ca.pem --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGCABAD
// RUN: PUB_SHA=$(sha256sum %t/lane-state-ed25519-public.pem | cut -d' ' -f1) && printf "lane-ed25519-1\t%t/lane-state-ed25519-public.pem\t2099-01-01\t\tactive\t${PUB_SHA}\n" > %t/lane-state-ed25519-keyring-future.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-ed25519-keyring-window --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-ed25519-keyring-future.state --reset-lane-state --lane-state-manifest-ed25519-private-key-file %t/lane-state-ed25519-private.pem --lane-state-manifest-ed25519-keyring-tsv %t/lane-state-ed25519-keyring-future.tsv --lane-state-manifest-ed25519-key-id lane-ed25519-1 --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEED25519KEYRINGWINDOW
// RUN: printf 'lane-state-ring-key-a\n' > %t/lane-state-ring-a.key
// RUN: KEYA_SHA=$(sha256sum %t/lane-state-ring-a.key | cut -d' ' -f1) && printf "lane-ring-a\t%t/lane-state-ring-a.key\t\t\tactive\t${KEYA_SHA}\n" > %t/lane-state-keyring.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-no-id --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-no-id.tsv --reset-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring.tsv --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGNOID
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-signed.tsv --reset-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring.tsv --lane-state-hmac-key-id lane-ring-a --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEKEYRINGMANIFEST < %t/lane-state-keyring-signed.tsv.manifest.json
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-resume --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-signed.tsv --resume-from-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring.tsv --lane-state-hmac-key-id lane-ring-a --include-lane-regex '^sv-tests/BMC$'
// RUN: FileCheck %s --check-prefix=LANESTATEKEYRINGRESUME < %t/out-lane-state-keyring-resume/summary.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-missing-id --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-signed.tsv --resume-from-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring.tsv --lane-state-hmac-key-id missing --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGMISSINGID
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-sha-bad --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-signed.tsv --resume-from-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring.tsv --lane-state-hmac-keyring-sha256 0000000000000000000000000000000000000000000000000000000000000000 --lane-state-hmac-key-id lane-ring-a --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGSHABAD
// RUN: KEYA_SHA=$(sha256sum %t/lane-state-ring-a.key | cut -d' ' -f1) && printf "lane-ring-baddate\t%t/lane-state-ring-a.key\t2026/02/09\t\tactive\t${KEYA_SHA}\n" > %t/lane-state-keyring-baddate.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-baddate --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-baddate-state.tsv --reset-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring-baddate.tsv --lane-state-hmac-key-id lane-ring-baddate --include-lane-regex "^$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGBADDATE
// RUN: KEYA_SHA=$(sha256sum %t/lane-state-ring-a.key | cut -d' ' -f1) && printf "lane-ring-future\t%t/lane-state-ring-a.key\t2099-01-01\t\tactive\t${KEYA_SHA}\n" > %t/lane-state-keyring-future.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-future-seed --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-future-state.tsv --reset-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring-future.tsv --lane-state-hmac-key-id lane-ring-future --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGWINDOW
// RUN: KEYA_SHA=$(sha256sum %t/lane-state-ring-a.key | cut -d' ' -f1) && printf "lane-ring-a\t%t/lane-state-ring-a.key\t2099-01-01\t\tactive\t${KEYA_SHA}\n" > %t/lane-state-keyring-future-verify.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-lane-state-keyring-future-verify --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --lane-state-tsv %t/lane-state-keyring-signed.tsv --resume-from-lane-state --lane-state-hmac-keyring-tsv %t/lane-state-keyring-future-verify.tsv --lane-state-hmac-key-id lane-ring-a --include-lane-regex "^sv-tests/BMC$"' 2>&1 | FileCheck %s --check-prefix=LANESTATEKEYRINGWINDOW
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests SVA summary: total=10 pass=9 fail=0 xfail=1 xpass=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tmissing_case\tbase\tFAIL\t2099-01-01\tstale_entry\n' > %t/expected-failure-cases-unmatched.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-cases-unmatched --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/expected-failure-cases-unmatched.tsv --fail-on-unmatched-expected-failure-cases' 2>&1 | FileCheck %s --check-prefix=CASEUNMATCHED
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nopentitan\tLEC\taes_sbox_canright\tbase\tXFAIL\t2099-01-01\tknown_xprop\n' > %t/expected-failure-cases-opentitan.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-opentitan-cases --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-opentitan --opentitan %t/opentitan --circt-verilog %t/fake-circt-verilog --circt-verilog-opentitan %t/fake-circt-verilog-opentitan --expected-failure-cases-file %t/expected-failure-cases-opentitan.tsv --fail-on-unexpected-failure-cases
// RUN: FileCheck %s --check-prefix=CASEOT < %t/out-opentitan-cases/expected-failure-cases-summary.tsv
// RUN: FileCheck %s --check-prefix=OPENTITANDETAIL < %t/out-opentitan-cases/opentitan-lec-results.txt
// RUN: printf '#!/usr/bin/env bash\nset -euo pipefail\nif [[ \"${CIRCT_VERILOG:-}\" != \"%t/fake-circt-verilog-avip\" ]]; then\n  echo \"bad_CIRCT_VERILOG_AVIP=${CIRCT_VERILOG:-}\"\n  exit 8\nfi\necho \"CIRCT_VERILOG_AVIP_FAIL_TEST\"\nexit 1\n' > %t/utils/run_avip_circt_verilog.sh
// RUN: chmod +x %t/utils/run_avip_circt_verilog.sh
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\navip/foo_avip\tcompile\tfoo_avip\tbase\tFAIL\t2099-01-01\tknown_avip_fail\n' > %t/expected-failure-cases-avip.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-avip-cases --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --with-avip --avip-glob %t/avip/* --circt-verilog %t/fake-circt-verilog --circt-verilog-avip %t/fake-circt-verilog-avip --expected-failure-cases-file %t/expected-failure-cases-avip.tsv --fail-on-unexpected-failure-cases
// RUN: FileCheck %s --check-prefix=CASEAVIP < %t/out-avip-cases/expected-failure-cases-summary.tsv
// RUN: FileCheck %s --check-prefix=AVIPDETAIL < %t/out-avip-cases/avip-results.txt
// RUN: printf '#!/usr/bin/env bash\nprintf "FAIL\\tbasic02\\t%t/sv-tests/tests/basic02.sv\\n" > "${OUT:-/dev/null}"\necho "sv-tests LEC summary: total=10 pass=9 fail=1 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_lec.sh
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\tnotes\nsv-tests\tLEC\t1\t0\tknown_issue\n' > %t/expected-failures.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-ok --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failures-file %t/expected-failures.tsv --fail-on-unexpected-failures --json-summary %t/out-expected-ok/summary.json
// RUN: FileCheck %s --check-prefix=EXPECTEDOK < %t/out-expected-ok/expected-failures-summary.tsv
// RUN: FileCheck %s --check-prefix=JSONEXPECTED < %t/out-expected-ok/summary.json
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\nsv-tests\tLEC\t0\t0\n' > %t/expected-failures-tight.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-fail --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failures-file %t/expected-failures-tight.tsv --fail-on-unexpected-failures' 2>&1 | FileCheck %s --check-prefix=EXPECTEDFAIL
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\nmissing-suite\tLEC\t0\t0\n' > %t/expected-failures-unused.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-unused --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failures-file %t/expected-failures-unused.tsv --fail-on-unused-expected-failures' 2>&1 | FileCheck %s --check-prefix=EXPECTEDUNUSED
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\tnotes\nsv-tests\tLEC\t1\t0\tkeep_budget\nmissing-suite\tLEC\t0\t0\tdrop_unused\n' > %t/prune-expected-failures.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-prune-budget --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failures-file %t/prune-expected-failures.tsv --prune-expected-failures-file %t/prune-expected-failures.tsv --prune-expected-failures-drop-unused
// RUN: FileCheck %s --check-prefix=PRUNEBUDGET < %t/prune-expected-failures.tsv
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\tnotes\nsv-tests\tLEC\t9\t9\tdry_keep\n' > %t/dryrun-refresh-expected-failures.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-dryrun-refresh-budget --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failures-file %t/dryrun-refresh-expected-failures.tsv --expectations-dry-run
// RUN: FileCheck %s --check-prefix=DRYRUNBUDGET < %t/dryrun-refresh-expected-failures.tsv
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\tnotes\nsv-tests\tLEC\t9\t9\tcarry_note\n' > %t/refresh-expected-failures.tsv
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2099-05-05\tkeep_reason\n' > %t/refresh-expected-failure-cases.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-refresh-expected --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failures-file %t/refresh-expected-failures.tsv --refresh-expected-failure-cases-file %t/refresh-expected-failure-cases.tsv --refresh-expected-failure-cases-default-expires-on 2099-12-31
// RUN: FileCheck %s --check-prefix=REFRESHBUDGET < %t/refresh-expected-failures.tsv
// RUN: FileCheck %s --check-prefix=REFRESHCASE < %t/refresh-expected-failure-cases.tsv
// RUN: printf 'suite\tmode\texpected_fail\texpected_error\tnotes\nsv-tests\tLEC\t9\t9\tcarry_note\nverilator-verification\tBMC\t3\t2\tdrop_me\n' > %t/refresh-expected-failures-filtered.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-refresh-expected-filtered --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failures-file %t/refresh-expected-failures-filtered.tsv --refresh-expected-failures-include-suite-regex '^sv-tests$' --refresh-expected-failures-include-mode-regex '^LEC$'
// RUN: FileCheck %s --check-prefix=REFRESHBUDGETFILTER < %t/refresh-expected-failures-filtered.tsv
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tBMC\t__aggregate__\taggregate\tXFAIL\t2099-07-07\tkeep_xfail\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2099-05-05\tkeep_reason\n' > %t/refresh-expected-failure-cases-filtered.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-refresh-case-filtered --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failure-cases-file %t/refresh-expected-failure-cases-filtered.tsv --refresh-expected-failure-cases-default-expires-on 2099-12-31 --refresh-expected-failure-cases-include-suite-regex '^sv-tests$' --refresh-expected-failure-cases-include-mode-regex '^BMC$' --refresh-expected-failure-cases-include-status-regex '^XFAIL$' --refresh-expected-failure-cases-include-id-regex '^__aggregate__$'
// RUN: FileCheck %s --check-prefix=REFRESHCASEFILTER < %t/refresh-expected-failure-cases-filtered.tsv
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tBMC\t__aggregate__\taggregate\tANY\t2099-06-06\tkeep_any\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2099-05-05\tkeep_reason\n' > %t/refresh-expected-failure-cases-any.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-refresh-expected-any --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failure-cases-file %t/refresh-expected-failure-cases-any.tsv --refresh-expected-failure-cases-default-expires-on 2099-12-31 --refresh-expected-failure-cases-collapse-status-any
// RUN: FileCheck %s --check-prefix=REFRESHANY < %t/refresh-expected-failure-cases-any.tsv
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2099-01-01\tkeep_matched\nsv-tests\tLEC\tstale_case\tbase\tFAIL\t2099-01-01\tdrop_unmatched\nsv-tests\tLEC\tbasic02\tbase\tANY\t2000-01-01\tdrop_expired\n' > %t/prune-expected-failure-cases.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-prune-expected --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/prune-expected-failure-cases.tsv --prune-expected-failure-cases-file %t/prune-expected-failure-cases.tsv --prune-expected-failure-cases-drop-unmatched --prune-expected-failure-cases-drop-expired
// RUN: FileCheck %s --check-prefix=PRUNECASE < %t/prune-expected-failure-cases.tsv
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tstale_case\tbase\tFAIL\t2099-01-01\tdry_keep_stale\n' > %t/dryrun-prune-expected-failure-cases.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-dryrun-prune-case --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/dryrun-prune-expected-failure-cases.tsv --prune-expected-failure-cases-file %t/dryrun-prune-expected-failure-cases.tsv --prune-expected-failure-cases-drop-unmatched --expectations-dry-run
// RUN: FileCheck %s --check-prefix=DRYRUNCASE < %t/dryrun-prune-expected-failure-cases.tsv
// RUN: rm -f %t/dryrun-report.jsonl
// RUN: printf 'dryrun-test-key\n' > %t/dryrun-hmac.key
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-dryrun-report --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --refresh-expected-failures-file %t/dryrun-refresh-expected-failures.tsv --refresh-expected-failure-cases-file %t/dryrun-prune-expected-failure-cases.tsv --expectations-dry-run --expectations-dry-run-report-jsonl %t/dryrun-report.jsonl --expectations-dry-run-report-hmac-key-file %t/dryrun-hmac.key --expectations-dry-run-report-hmac-key-id lit-key-1
// RUN: FileCheck %s --check-prefix=DRYRUNREPORT < %t/dryrun-report.jsonl
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-key-file %t/dryrun-hmac.key --expected-hmac-key-id lit-key-1 %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFY
// RUN: cp %t/dryrun-report.jsonl %t/dryrun-report-bad.jsonl
// RUN: sed -i 's/"row_count": 3/"row_count": 99/' %t/dryrun-report-bad.jsonl
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py %t/dryrun-report-bad.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYBAD
// RUN: printf 'wrong-key\n' > %t/dryrun-hmac-bad.key
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-key-file %t/dryrun-hmac-bad.key %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYHMACBAD
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-key-file %t/dryrun-hmac.key --expected-hmac-key-id wrong-key-id %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYIDBAD
// RUN: printf 'lit-key-1\t%t/dryrun-hmac.key\nother-key\t%t/dryrun-hmac-bad.key\n' > %t/dryrun-hmac-keyring.tsv
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRING
// RUN: KEYRING_SHA=$(sha256sum %t/dryrun-hmac-keyring.tsv | cut -d' ' -f1) && python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-sha256 "$KEYRING_SHA" %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGSHA
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-sha256 0000000000000000000000000000000000000000000000000000000000000000 %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGSHABAD
// RUN: KEYRING_SHA=$(sha256sum %t/dryrun-hmac-keyring.tsv | cut -d' ' -f1) && python3 -c "import json,hmac,hashlib,pathlib; m={'schema_version':1,'signer_id':'lit-signer','keyring_sha256':'$KEYRING_SHA','expires_on':'2099-12-31'}; b=json.dumps(m,sort_keys=True,separators=(',',':')).encode(); s=hmac.new(pathlib.Path(r'%t/dryrun-hmac.key').read_bytes(), b, hashlib.sha256).hexdigest(); m['signature_hmac_sha256']=s; pathlib.Path(r'%t/dryrun-hmac-keyring.manifest.json').write_text(json.dumps(m), encoding='utf-8')"
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.json --hmac-keyring-manifest-hmac-key-file %t/dryrun-hmac.key --expected-keyring-signer-id lit-signer %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFEST
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.json --hmac-keyring-manifest-hmac-key-file %t/dryrun-hmac.key --expected-keyring-signer-id wrong-signer %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTBAD
// RUN: openssl genpkey -algorithm ed25519 -out %t/manifest-ed25519-private.pem
// RUN: openssl pkey -in %t/manifest-ed25519-private.pem -pubout -out %t/manifest-ed25519-public.pem
// RUN: KEYRING_SHA=$(sha256sum %t/dryrun-hmac-keyring.tsv | cut -d' ' -f1) && python3 -c "import json,pathlib; m={'schema_version':1,'signer_id':'lit-ed25519','keyring_sha256':'$KEYRING_SHA','expires_on':'2099-12-31'}; payload=json.dumps(m,sort_keys=True,separators=(',',':')).encode(); pathlib.Path(r'%t/dryrun-hmac-keyring.manifest.ed25519.payload').write_bytes(payload); pathlib.Path(r'%t/dryrun-hmac-keyring.manifest.ed25519.json').write_text(json.dumps(m), encoding='utf-8')"
// RUN: openssl pkeyutl -sign -inkey %t/manifest-ed25519-private.pem -rawin -in %t/dryrun-hmac-keyring.manifest.ed25519.payload -out %t/dryrun-hmac-keyring.manifest.ed25519.sig
// RUN: python3 -c "import base64,json,pathlib; p=pathlib.Path(r'%t/dryrun-hmac-keyring.manifest.ed25519.json'); m=json.loads(p.read_text(encoding='utf-8')); m['signature_ed25519_base64']=base64.b64encode(pathlib.Path(r'%t/dryrun-hmac-keyring.manifest.ed25519.sig').read_bytes()).decode('ascii'); p.write_text(json.dumps(m), encoding='utf-8')"
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-ed25519-public-key-file %t/manifest-ed25519-public.pem --expected-keyring-signer-id lit-ed25519 %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTED25519
// RUN: openssl genpkey -algorithm ed25519 -out %t/manifest-ed25519-wrong-private.pem
// RUN: openssl pkey -in %t/manifest-ed25519-wrong-private.pem -pubout -out %t/manifest-ed25519-wrong-public.pem
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-ed25519-public-key-file %t/manifest-ed25519-wrong-public.pem %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTED25519BAD
// RUN: PUB_KEY_SHA=$(sha256sum %t/manifest-ed25519-public.pem | cut -d' ' -f1) && printf "lit-ed25519\t%t/manifest-ed25519-public.pem\t\t\tactive\t${PUB_KEY_SHA}\n" > %t/manifest-ed25519-signer-keyring.tsv
// RUN: SIGNER_KEYRING_SHA=$(sha256sum %t/manifest-ed25519-signer-keyring.tsv | cut -d' ' -f1) && python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-ed25519-keyring-tsv %t/manifest-ed25519-signer-keyring.tsv --hmac-keyring-manifest-ed25519-keyring-sha256 "$SIGNER_KEYRING_SHA" --expected-keyring-signer-id lit-ed25519 %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTED25519RING
// RUN: printf "other-signer\t%t/manifest-ed25519-public.pem\n" > %t/manifest-ed25519-signer-keyring-missing.tsv
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-ed25519-keyring-tsv %t/manifest-ed25519-signer-keyring-missing.tsv %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTED25519RINGBAD
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-hmac-key-file %t/dryrun-hmac.key --hmac-keyring-manifest-ed25519-public-key-file %t/manifest-ed25519-public.pem %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTMODEBAD
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv --hmac-keyring-manifest-json %t/dryrun-hmac-keyring.manifest.ed25519.json --hmac-keyring-manifest-ed25519-public-key-file %t/manifest-ed25519-public.pem --hmac-keyring-manifest-ed25519-keyring-tsv %t/manifest-ed25519-signer-keyring.tsv %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGMANIFESTMODEBAD
// RUN: cd %t && printf 'lit-key-1\tdryrun-hmac.key\n' > dryrun-hmac-keyring-relative.tsv
// RUN: cd %t && python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv dryrun-hmac-keyring-relative.tsv dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGREL
// RUN: KEY_SHA=$(sha256sum %t/dryrun-hmac.key | cut -d' ' -f1) && printf "lit-key-1\t%t/dryrun-hmac.key\t\t\tactive\t${KEY_SHA}\n" > %t/dryrun-hmac-keyring-keysha.tsv
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring-keysha.tsv %t/dryrun-report.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGKEYSHA
// RUN: printf 'lit-key-1\t%t/dryrun-hmac.key\t\t\tactive\t0000000000000000000000000000000000000000000000000000000000000000\n' > %t/dryrun-hmac-keyring-keysha-bad.tsv
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring-keysha-bad.tsv %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGKEYSHABAD
// RUN: cp %t/dryrun-report.jsonl %t/dryrun-report-keyring-bad.jsonl
// RUN: sed -i 's/"hmac_key_id": "lit-key-1"/"hmac_key_id": "missing-key"/g' %t/dryrun-report-keyring-bad.jsonl
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring.tsv %t/dryrun-report-keyring-bad.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGBAD
// RUN: printf 'lit-key-1\t%t/dryrun-hmac.key\t\t\trevoked\n' > %t/dryrun-hmac-keyring-revoked.tsv
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring-revoked.tsv %t/dryrun-report.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGREVOKED
// RUN: printf 'lit-key-1\t%t/dryrun-hmac.key\t2000-01-01\t2000-12-31\n' > %t/dryrun-hmac-keyring-window.tsv
// RUN: cp %t/dryrun-report.jsonl %t/dryrun-report-keyring-window-bad.jsonl
// RUN: sed -i 's/"date": "[0-9-]\{10\}"/"date": "1999-01-01"/g' %t/dryrun-report-keyring-window-bad.jsonl
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py --hmac-keyring-tsv %t/dryrun-hmac-keyring-window.tsv %t/dryrun-report-keyring-window-bad.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYKEYRINGWINDOWBAD
// RUN: printf '{"operation":"refresh_expected_failures","target_file":"legacy.tsv"}\n' > %t/dryrun-report-legacy-prefix.jsonl
// RUN: cat %t/dryrun-report.jsonl >> %t/dryrun-report-legacy-prefix.jsonl
// RUN: not python3 %S/../../utils/verify_formal_dryrun_report.py %t/dryrun-report-legacy-prefix.jsonl 2>&1 | FileCheck %s --check-prefix=DRYRUNVERIFYLEGACYBAD
// RUN: python3 %S/../../utils/verify_formal_dryrun_report.py --allow-legacy-prefix --hmac-key-file %t/dryrun-hmac.key --expected-hmac-key-id lit-key-1 %t/dryrun-report-legacy-prefix.jsonl | FileCheck %s --check-prefix=DRYRUNVERIFYLEGACY
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2099-01-01\tknown_case\n' > %t/expected-failure-cases.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-cases-ok --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/expected-failure-cases.tsv --fail-on-unexpected-failure-cases --fail-on-expired-expected-failure-cases --json-summary %t/out-expected-cases-ok/summary.json
// RUN: FileCheck %s --check-prefix=CASEOK < %t/out-expected-cases-ok/expected-failure-cases-summary.tsv
// RUN: FileCheck %s --check-prefix=JSONCASE < %t/out-expected-cases-ok/summary.json
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tother_case\tbase\tFAIL\t2099-01-01\twrong_case\n' > %t/expected-failure-cases-unexpected.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-cases-unexpected --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/expected-failure-cases-unexpected.tsv --fail-on-unexpected-failure-cases' 2>&1 | FileCheck %s --check-prefix=CASEUNEXPECTED
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nsv-tests\tLEC\tbasic02\tbase\tFAIL\t2000-01-01\texpired_case\n' > %t/expected-failure-cases-expired.tsv
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-cases-expired --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/expected-failure-cases-expired.tsv --fail-on-expired-expected-failure-cases' 2>&1 | FileCheck %s --check-prefix=CASEEXPIRED
// RUN: printf '#!/usr/bin/env bash\nprintf "PASS\\tbasic01\\t%t/sv-tests/tests/basic01.sv\\n" > "${OUT:-/dev/null}"\necho "sv-tests LEC summary: total=10 pass=10 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_lec.sh
// RUN: printf '#!/usr/bin/env bash\necho "yosys SVA summary: 4 tests, failures=1, xfail=0, xpass=0, skipped=0"\n' > %t/utils/run_yosys_sva_circt_bmc.sh
// RUN: chmod +x %t/utils/run_yosys_sva_circt_bmc.sh
// RUN: printf 'suite\tmode\tid\tid_kind\tstatus\texpires_on\treason\nyosys/tests/sva\tBMC\t__aggregate__\taggregate\tFAIL\t2099-01-01\tknown_yosys_bmc_gap\n' > %t/expected-failure-cases-aggregate.tsv
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-expected-cases-aggregate --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --expected-failure-cases-file %t/expected-failure-cases-aggregate.tsv --fail-on-unexpected-failure-cases --json-summary %t/out-expected-cases-aggregate/summary.json
// RUN: FileCheck %s --check-prefix=CASEAGG < %t/out-expected-cases-aggregate/expected-failure-cases-summary.tsv
// RUN: printf '#!/usr/bin/env bash\necho "yosys SVA summary: 4 tests, failures=0, xfail=0, xpass=0, skipped=0"\n' > %t/utils/run_yosys_sva_circt_bmc.sh
// RUN: chmod +x %t/utils/run_yosys_sva_circt_bmc.sh
//
// RUN: printf '#!/usr/bin/env bash\necho "verilator-verification summary: total=10 pass=10 fail=0 xfail=0 xpass=1 error=0 skip=0"\n' > %t/utils/run_verilator_verification_circt_bmc.sh
// RUN: chmod +x %t/utils/run_verilator_verification_circt_bmc.sh
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-xpass --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --baseline-file %t/formal-baselines.tsv --strict-gate' 2>&1 | FileCheck %s --check-prefix=STRICTXPASS
//
// RUN: printf '#!/usr/bin/env bash\necho "verilator-verification summary: total=10 pass=10 fail=0 xfail=0 xpass=0 error=0 skip=0"\n' > %t/utils/run_verilator_verification_circt_bmc.sh
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=8 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_verilator_verification_circt_bmc.sh %t/utils/run_sv_tests_circt_lec.sh
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-rate --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --baseline-file %t/formal-baselines.tsv --fail-on-passrate-regression' 2>&1 | FileCheck %s --check-prefix=STRICTRATE
//
// RUN: printf '9999-12-31\tsv-tests\tLEC\t10\t8\t0\t0\t0\t0\t0\t80.000\ttotal=10 pass=8 fail=0 xfail=0 xpass=0 error=0 skip=0\n' >> %t/formal-baselines.tsv
// RUN: printf '#!/usr/bin/env bash\necho "sv-tests LEC summary: total=10 pass=9 fail=0 error=0 skip=0"\n' > %t/utils/run_sv_tests_circt_lec.sh
// RUN: chmod +x %t/utils/run_sv_tests_circt_lec.sh
// RUN: not sh -c 'cd %t && utils/run_formal_all.sh --out-dir %t/out-window --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --baseline-file %t/formal-baselines.tsv --fail-on-passrate-regression --baseline-window 2' 2>&1 | FileCheck %s --check-prefix=STRICTWINDOW
// RUN: cd %t && utils/run_formal_all.sh --out-dir %t/out-window-days --sv-tests %t/sv-tests --verilator %t/verilator --yosys %t/yosys --baseline-file %t/formal-baselines.tsv --fail-on-passrate-regression --baseline-window 2 --baseline-window-days 30
//
// JSON: "rows"
// JSON: "suite": "sv-tests"
// JSON: "mode": "BMC"
// JSON: "pass_rate":
// BASELINE: date{{[[:space:]]+}}suite{{[[:space:]]+}}mode{{[[:space:]]+}}total{{[[:space:]]+}}pass{{[[:space:]]+}}fail{{[[:space:]]+}}xfail{{[[:space:]]+}}xpass{{[[:space:]]+}}error{{[[:space:]]+}}skip{{[[:space:]]+}}pass_rate{{[[:space:]]+}}result
// BASELINE: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}100.000{{[[:space:]]+}}total=10 pass=9 fail=0 xfail=1 xpass=0 error=0 skip=0
// AVIPPATH: avip/foo_avip{{[[:space:]]+}}compile{{[[:space:]]+}}1{{[[:space:]]+}}1{{[[:space:]]+}}0
// AVIPENV: CIRCT_VERILOG_AVIP_OK
// OPENTITANPATH: opentitan{{[[:space:]]+}}LEC{{[[:space:]]+}}1{{[[:space:]]+}}1{{[[:space:]]+}}0
// OPENTITANENV: CIRCT_VERILOG_OPENTITAN_OK
// LANEINCLUDE: sv-tests{{[[:space:]]+}}BMC
// LANEINCLUDE: sv-tests{{[[:space:]]+}}LEC
// LANEINCLUDE-NOT: verilator-verification
// LANEINCLUDE-NOT: yosys/tests/sva
// LANEINCLUDE-NOT: opentitan
// LANEINCLUDE-NOT: avip/foo_avip
// LANEEXCLUDE: sv-tests{{[[:space:]]+}}BMC
// LANEEXCLUDE-NOT: sv-tests{{[[:space:]]+}}LEC
// LANERESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANERESET: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}1{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEBADFLAGS: --resume-from-lane-state and --reset-lane-state are mutually exclusive
// LANESTATEKEYIDNOFILE: --lane-state-hmac-key-id requires --lane-state-hmac-key-file or --lane-state-hmac-keyring-tsv
// LANESTATEKEYFILENOSTATE: --lane-state-hmac-key-file requires --lane-state-tsv
// LANESTATEKEYRINGNOSTATE: --lane-state-hmac-keyring-tsv requires --lane-state-tsv
// LANESTATEKEYRINGSHANORING: --lane-state-hmac-keyring-sha256 requires --lane-state-hmac-keyring-tsv
// LANESTATEKEYSOURCECONFLICT: --lane-state-hmac-key-file and --lane-state-hmac-keyring-tsv are mutually exclusive
// LANESTATEED25519PRIVATEONLY: --lane-state-manifest-ed25519-private-key-file requires --lane-state-manifest-ed25519-public-key-file or --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEED25519PUBLICONLY: --lane-state-manifest-ed25519-public-key-file requires --lane-state-manifest-ed25519-private-key-file
// LANESTATEED25519KEYRINGNOPRIVATE: --lane-state-manifest-ed25519-keyring-tsv requires --lane-state-manifest-ed25519-private-key-file
// LANESTATEED25519KEYRINGSHANORING: --lane-state-manifest-ed25519-keyring-sha256 requires --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEED25519CANORING: --lane-state-manifest-ed25519-ca-file requires --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEED25519CRLNORING: --lane-state-manifest-ed25519-crl-file requires --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEED25519CRLNOCA: --lane-state-manifest-ed25519-crl-file requires --lane-state-manifest-ed25519-ca-file
// LANESTATEED25519CRLREFRESHNOCRL: --lane-state-manifest-ed25519-crl-refresh-cmd requires --lane-state-manifest-ed25519-crl-file
// LANESTATEED25519CRLREFRESHURINOCRL: --lane-state-manifest-ed25519-crl-refresh-uri requires --lane-state-manifest-ed25519-crl-file
// LANESTATEED25519CRLREFRESHAUTOURINOCRL: --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp requires --lane-state-manifest-ed25519-crl-file
// LANESTATEED25519CRLAUTOPOLICYNOMODE: --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy requires --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519AUTOPOLICYINVALID: invalid --lane-state-manifest-ed25519-refresh-auto-uri-policy: expected one of first,last,require_single
// LANESTATEED25519AUTOSCHEMESINVALID: invalid --lane-state-manifest-ed25519-refresh-auto-uri-allowed-schemes: expected comma-separated subset of file,http,https
// LANESTATEED25519AUTOPROFILENOJSON: --lane-state-manifest-ed25519-refresh-policy-profile requires --lane-state-manifest-ed25519-refresh-policy-profiles-json
// LANESTATEED25519AUTOJSONNOPROFILE: --lane-state-manifest-ed25519-refresh-policy-profiles-json requires --lane-state-manifest-ed25519-refresh-policy-profile
// LANESTATEED25519AUTOJSONSHANOJSON: --lane-state-manifest-ed25519-refresh-policy-profiles-sha256 requires --lane-state-manifest-ed25519-refresh-policy-profiles-json
// LANESTATEED25519AUTOJSONSHABAD: invalid --lane-state-manifest-ed25519-refresh-policy-profiles-sha256: expected 64 hex chars
// LANESTATEED25519AUTOJSONSHAMISMATCH: refresh policy profiles SHA256 mismatch: expected 0000000000000000000000000000000000000000000000000000000000000000
// LANESTATEED25519AUTOMANIFESTNOJSON: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json requires --lane-state-manifest-ed25519-refresh-policy-profiles-json
// LANESTATEED25519AUTOMANIFESTPUBKEYNOMANIFEST: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json
// LANESTATEED25519AUTOMANIFESTKEYRINGNOMANIFEST: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json
// LANESTATEED25519AUTOMANIFESTKEYRINGSHANOKEYRING: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-sha256 requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv
// LANESTATEED25519AUTOMANIFESTKEYRINGSHABAD: invalid --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-sha256: expected 64 hex chars
// LANESTATEED25519AUTOMANIFESTPUBKEYKEYRINGCONFLICT: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file and --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv are mutually exclusive
// LANESTATEED25519AUTOMANIFESTKEYRINGCANOKEYRING: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-ca-file requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv
// LANESTATEED25519AUTOMANIFESTKEYIDNOMANIFEST: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-key-id requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json
// LANESTATEED25519AUTOMANIFESTNOPUBKEY: --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-json requires --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-public-key-file or --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv
// LANESTATEED25519CRLAUTOSCHEMESNOMODE: --lane-state-manifest-ed25519-crl-refresh-auto-uri-allowed-schemes requires --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHRETRIESNOCMD: --lane-state-manifest-ed25519-crl-refresh-retries requires --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, or --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHDELAYNOCMD: --lane-state-manifest-ed25519-crl-refresh-delay-secs requires --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, or --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHTIMEOUTNOCMD: --lane-state-manifest-ed25519-crl-refresh-timeout-secs requires --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, or --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHJITTERNOCMD: --lane-state-manifest-ed25519-crl-refresh-jitter-secs requires --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, or --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHMETADATANOCMD: --lane-state-manifest-ed25519-crl-refresh-metadata-file requires --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, or --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp
// LANESTATEED25519CRLREFRESHMETADATATRANSPORTNOMETA: --lane-state-manifest-ed25519-crl-refresh-metadata-require-transport requires --lane-state-manifest-ed25519-crl-refresh-metadata-file
// LANESTATEED25519CRLREFRESHMETADATAMAXAGENOMETA: --lane-state-manifest-ed25519-crl-refresh-metadata-max-age-secs requires --lane-state-manifest-ed25519-crl-refresh-metadata-file
// LANESTATEED25519OCSPNORING: --lane-state-manifest-ed25519-ocsp-response-file requires --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEED25519OCSPNOCA: --lane-state-manifest-ed25519-ocsp-response-file requires --lane-state-manifest-ed25519-ca-file
// LANESTATEED25519OCSPREFRESHNORESP: --lane-state-manifest-ed25519-ocsp-refresh-cmd requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPREFRESHURINORESP: --lane-state-manifest-ed25519-ocsp-refresh-uri requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPREFRESHAUTOURINORESP: --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPAUTOPOLICYNOMODE: --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-policy requires --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPAUTOSCHEMESNOMODE: --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-allowed-schemes requires --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHRETRIESNOCMD: --lane-state-manifest-ed25519-ocsp-refresh-retries requires --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, or --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHDELAYNOCMD: --lane-state-manifest-ed25519-ocsp-refresh-delay-secs requires --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, or --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHTIMEOUTNOCMD: --lane-state-manifest-ed25519-ocsp-refresh-timeout-secs requires --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, or --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHJITTERNOCMD: --lane-state-manifest-ed25519-ocsp-refresh-jitter-secs requires --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, or --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHMETADATANOCMD: --lane-state-manifest-ed25519-ocsp-refresh-metadata-file requires --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, or --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia
// LANESTATEED25519OCSPREFRESHMETADATASTATUSNOMETA: --lane-state-manifest-ed25519-ocsp-refresh-metadata-require-status requires --lane-state-manifest-ed25519-ocsp-refresh-metadata-file
// LANESTATEED25519OCSPREFRESHMETADATAFUTURESKEWNOMETA: --lane-state-manifest-ed25519-ocsp-refresh-metadata-max-future-skew-secs requires --lane-state-manifest-ed25519-ocsp-refresh-metadata-file
// LANESTATEED25519OCSPSHANORESP: --lane-state-manifest-ed25519-ocsp-response-sha256 requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPRESPCERTNORESP: --lane-state-manifest-ed25519-ocsp-responder-cert-file requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPISSUERCERTNORESP: --lane-state-manifest-ed25519-ocsp-issuer-cert-file requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPRESPCERTSHANOCERT: --lane-state-manifest-ed25519-ocsp-responder-cert-sha256 requires --lane-state-manifest-ed25519-ocsp-responder-cert-file
// LANESTATEED25519OCSPRESPREQUIREEKUNOCERT: --lane-state-manifest-ed25519-ocsp-require-responder-ocsp-signing requires --lane-state-manifest-ed25519-ocsp-responder-cert-file
// LANESTATEED25519OCSPRESPREQUIREAKINOCERT: --lane-state-manifest-ed25519-ocsp-require-responder-aki-match-ca-ski requires --lane-state-manifest-ed25519-ocsp-responder-cert-file
// LANESTATEED25519OCSPMAXAGENORESP: --lane-state-manifest-ed25519-ocsp-max-age-secs requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPNUNORESP: --lane-state-manifest-ed25519-ocsp-require-next-update requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519OCSPRESPIDNORESP: --lane-state-manifest-ed25519-ocsp-responder-id-regex requires --lane-state-manifest-ed25519-ocsp-response-file
// LANESTATEED25519SUBJECTNORING: --lane-state-manifest-ed25519-cert-subject-regex requires --lane-state-manifest-ed25519-keyring-tsv
// LANESTATEBADPOLICY: lane state compatibility policy version mismatch for lane sv-tests/BMC; expected 1, found 2
// LANESTATEBADHASH: lane state config hash mismatch for lane sv-tests/BMC
// LANEMERGERESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANEMERGERESUME: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}10{{[[:space:]]+}}10{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANEMERGECONFLICT: conflicting lane state config hash for lane sv-tests/BMC
// LANESTATEMANIFEST: "hmac_key_id": "lane-key-1"
// LANESTATEMANIFEST: "lane_state_file": "{{.*}}lane-state-signed.tsv"
// LANESTATEMANIFEST: "lane_state_sha256":
// LANESTATEMANIFEST: "signature_hmac_sha256":
// LANESTATESIGNEDRESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEBADSHA: invalid lane-state manifest for {{.*}}lane-state-signed.tsv: lane_state_sha256 mismatch
// LANESTATEBADKEYID: invalid lane-state manifest for {{.*}}lane-state-signed.tsv: hmac_key_id mismatch
// LANESTATEMISSINGMANIFEST: missing lane-state manifest for {{.*}}lane-state-signed.tsv
// LANESTATEED25519MANIFEST: "ed25519_key_id": "lane-ed25519-1"
// LANESTATEED25519MANIFEST: "signature_ed25519_base64":
// LANESTATEED25519MANIFEST: "signature_mode": "ed25519"
// LANESTATEED25519RESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEED25519BADSIG: invalid lane-state manifest for {{.*}}: signature_ed25519_base64 verification failed
// LANESTATEED25519BADKEYID: invalid lane-state manifest for {{.*}}: ed25519_key_id mismatch
// LANESTATEED25519KEYRINGNOID: --lane-state-manifest-ed25519-keyring-tsv requires --lane-state-manifest-ed25519-key-id
// LANESTATEED25519KEYRINGMANIFEST: "ed25519_cert_sha256":
// LANESTATEED25519KEYRINGMANIFEST: "ed25519_key_id": "lane-ed25519-1"
// LANESTATEED25519KEYRINGMANIFEST: "signature_ed25519_base64":
// LANESTATEED25519KEYRINGMANIFEST: "signature_mode": "ed25519"
// LANESTATEED25519KEYRINGRESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEED25519KEYRINGCAMANIFEST: "ed25519_cert_sha256":
// LANESTATEED25519KEYRINGCARESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEED25519KEYRINGCASUBJECT: "ed25519_cert_sha256":
// LANESTATEED25519KEYRINGCACRL: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRL: "artifact_kind": "crl"
// LANESTATEED25519KEYRINGCACRL: "source_metadata":
// LANESTATEED25519KEYRINGCACRL: "source": "lit-crl-refresh"
// LANESTATEED25519KEYRINGCACRL: "transport": "file"
// LANESTATEED25519KEYRINGCACRL: "ed25519_crl_sha256":
// LANESTATEED25519KEYRINGCACRLURI: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLURI: "source_metadata":
// LANESTATEED25519KEYRINGCACRLURI: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLURI: "transport": "file"
// LANESTATEED25519KEYRINGCACRLURI: "uri": "file://{{.*}}lane-state-ed25519.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURI: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURI: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURI: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURI: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURI: "uri": "file://{{.*}}lane-state-ed25519.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURILAST: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURILAST: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURILAST: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURILAST: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURILAST: "uri": "file://{{.*}}lane-state-ed25519-alt.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELAST: "uri": "file://{{.*}}lane-state-ed25519-alt.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURIPROFILELASTKEYRING: "uri": "file://{{.*}}lane-state-ed25519-alt.crl.pem"
// LANESTATEED25519KEYRINGCAAUTOMANIFESTBADSIG: invalid refresh policy profiles manifest: signature verification failed
// LANESTATEED25519KEYRINGCAAUTOMANIFESTBADKEYID: invalid refresh policy profiles manifest: key_id mismatch (expected 'wrong-profile-key', found 'profile-key-1')
// LANESTATEED25519KEYRINGCAAUTOMANIFESTKEYRINGNOCERT: refresh policy profiles manifest signer key_id 'profile-key-1' missing cert_file_path while --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-ca-file is set
// LANESTATEED25519KEYRINGCAAUTOMANIFESTKEYRINGNOKEYID: invalid refresh policy profiles manifest: key_id must be non-empty string when --lane-state-manifest-ed25519-refresh-policy-profiles-manifest-keyring-tsv is set
// LANESTATEED25519KEYRINGCAAUTOPROFILEUNKNOWN: invalid --lane-state-manifest-ed25519-refresh-policy-profile: unknown profile 'missing'
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESSHAREDBAD: lane state Ed25519 certificate CRL Distribution Points has no URI matching allowed schemes 'https' for key_id '{{.*}}'
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURISCHEMESOVERRIDE: "uri": "file://{{.*}}lane-state-ed25519.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE: "ed25519_crl_refresh_provenance":
// LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE: "source_metadata":
// LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE: "transport": "file"
// LANESTATEED25519KEYRINGCACRLAUTOURIOVERRIDE: "uri": "file://{{.*}}lane-state-ed25519.crl.pem"
// LANESTATEED25519KEYRINGCACRLAUTOURIREQUIRESINGLEBAD: lane state Ed25519 certificate CRL Distribution Points has 2 usable URIs for key_id '{{.*}}' while --auto-uri-policy=require_single
// LANESTATEED25519KEYRINGCACRLAUTOURIPOLICYINVALID: invalid --lane-state-manifest-ed25519-crl-refresh-auto-uri-policy: expected one of first,last,require_single
// LANESTATEED25519KEYRINGCACRLURINOMETA: --lane-state-manifest-ed25519-crl-refresh-uri requires --lane-state-manifest-ed25519-crl-refresh-metadata-file
// LANESTATEED25519KEYRINGCACRLAUTOURINOMETA: --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp requires --lane-state-manifest-ed25519-crl-refresh-metadata-file
// LANESTATEED25519KEYRINGCACRLMODECONFLICT: --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, and --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp are mutually exclusive
// LANESTATEED25519KEYRINGCACRLAUTOURIMODECONFLICT: --lane-state-manifest-ed25519-crl-refresh-cmd, --lane-state-manifest-ed25519-crl-refresh-uri, and --lane-state-manifest-ed25519-crl-refresh-auto-uri-from-cert-cdp are mutually exclusive
// LANESTATEED25519KEYRINGCACRLBADMETADATA: invalid lane state Ed25519 refresh metadata file '{{.*}}lane-state-ed25519-refresh-crl.bad-metadata.json': schema_version must be 1
// LANESTATEED25519KEYRINGCACRLMETADATAPOLICYBAD: invalid lane state Ed25519 refresh metadata file '{{.*}}lane-state-ed25519-refresh-crl.metadata.json': transport policy mismatch
// LANESTATEED25519KEYRINGCACRLMETADATASTALE: invalid lane state Ed25519 refresh metadata file '{{.*}}lane-state-ed25519-refresh-crl.stale-metadata.json': fetched_at_utc age policy mismatch
// LANESTATEED25519KEYRINGCAOCSP: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGSHABAD: lane state Ed25519 keyring SHA256 mismatch:
// LANESTATEED25519KEYRINGCANOCERT: lane state Ed25519 keyring key_id '{{.*}}' missing cert_file_path while --lane-state-manifest-ed25519-ca-file is set
// LANESTATEED25519KEYRINGCACRLSTALE: lane state Ed25519 CRL is stale for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCAOCSPSTALE: lane state Ed25519 OCSP response is stale for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "ed25519_ocsp_refresh_provenance":
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "artifact_kind": "ocsp"
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "source_metadata":
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "source": "lit-ocsp-refresh"
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "transport": "https"
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "uri": "https://ocsp.example.test"
// LANESTATEED25519KEYRINGCAOCSPREFRESH: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGCAOCSPREFRESHURI: "ed25519_ocsp_refresh_provenance":
// LANESTATEED25519KEYRINGCAOCSPREFRESHURI: "source_metadata":
// LANESTATEED25519KEYRINGCAOCSPREFRESHURI: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCAOCSPREFRESHURI: "transport": "file"
// LANESTATEED25519KEYRINGCAOCSPREFRESHURI: "uri": "file://{{.*}}lane-state-ed25519-good.ocsp.der"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI: "ed25519_ocsp_refresh_provenance":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI: "source_metadata":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI: "transport": "file"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURI: "uri": "file://{{.*}}lane-state-ed25519-good.ocsp.der"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST: "ed25519_ocsp_refresh_provenance":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST: "source_metadata":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST: "transport": "file"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURILAST: "uri": "file://{{.*}}lane-state-ed25519-alt.ocsp.der"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST: "ed25519_ocsp_refresh_provenance":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST: "source_metadata":
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST: "source": "built_in_fetch"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST: "transport": "file"
// LANESTATEED25519KEYRINGCAOCSPREFRESHAUTOURIPROFILELAST: "uri": "file://{{.*}}lane-state-ed25519-alt.ocsp.der"
// LANESTATEED25519KEYRINGCAOCSPAUTOURIREQUIRESINGLEBAD: lane state Ed25519 certificate Authority Information Access has 2 usable URIs for key_id '{{.*}}' while --auto-uri-policy=require_single
// LANESTATEED25519KEYRINGCAOCSPAUTOURIPOLICYINVALID: invalid --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-policy: expected one of first,last,require_single
// LANESTATEED25519KEYRINGCAOCSPMODECONFLICT: --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, and --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia are mutually exclusive
// LANESTATEED25519KEYRINGCAOCSPAUTOURINOMETA: --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia requires --lane-state-manifest-ed25519-ocsp-refresh-metadata-file
// LANESTATEED25519KEYRINGCAOCSPAUTOURIMODECONFLICT: --lane-state-manifest-ed25519-ocsp-refresh-cmd, --lane-state-manifest-ed25519-ocsp-refresh-uri, and --lane-state-manifest-ed25519-ocsp-refresh-auto-uri-from-cert-aia are mutually exclusive
// LANESTATEED25519KEYRINGCAOCSPREFRESHBADHTTPSMETADATA: invalid lane state Ed25519 refresh metadata file '{{.*}}lane-state-ed25519-refresh-ocsp.bad-https-metadata.json': https transport requires tls_peer_sha256
// LANESTATEED25519KEYRINGCAOCSPREFRESHFUTURESKEWBAD: invalid lane state Ed25519 refresh metadata file '{{.*}}lane-state-ed25519-refresh-ocsp.metadata.json': fetched_at_utc future-skew policy mismatch
// LANESTATEED25519KEYRINGCAOCSPRETRY: "attempts_used": 2
// LANESTATEED25519KEYRINGCAOCSPRETRY: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGCAOCSPTIMEOUTRETRY: "timed_out": true
// LANESTATEED25519KEYRINGCAOCSPTIMEOUTRETRY: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGCAOCSPNEXTUPDATEMISSING: lane state Ed25519 OCSP nextUpdate missing for key_id '{{.*}}'
// LANESTATEED25519KEYRINGCAOCSPSHABAD: lane state Ed25519 OCSP response SHA256 mismatch for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCAOCSPNEXTUPDATE: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGCAOCSPRESPCERT: "ed25519_ocsp_responder_cert_sha256":
// LANESTATEED25519KEYRINGCAOCSPRESPCERTEKU: "ed25519_ocsp_issuer_cert_sha256":
// LANESTATEED25519KEYRINGCAOCSPRESPCERTEKU: "ed25519_ocsp_responder_cert_sha256":
// LANESTATEED25519KEYRINGCAOCSPRESPCERTEKUBAD: lane state Ed25519 OCSP responder cert EKU missing OCSP Signing for key_id '{{.*}}'
// LANESTATEED25519KEYRINGCAOCSPRESPCERTSHABAD: lane state Ed25519 OCSP responder cert SHA256 mismatch for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCAOCSPRESPID: "ed25519_ocsp_sha256":
// LANESTATEED25519KEYRINGCAOCSPRESPIDBAD: lane state Ed25519 OCSP responder-id mismatch for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCACRLBAD: lane state Ed25519 certificate verify failed for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCAOCSPBAD: lane state Ed25519 OCSP status is revoked for key_id '{{.*}}'
// LANESTATEED25519KEYRINGCASUBJECTBAD: lane state Ed25519 certificate subject mismatch for key_id '{{.*}}':
// LANESTATEED25519KEYRINGCABAD: lane state Ed25519 certificate verify failed for key_id '{{.*}}':
// LANESTATEED25519KEYRINGWINDOW: lane state Ed25519 key_id '{{.*}}' not active at generated_at_utc
// LANESTATEKEYRINGNOID: --lane-state-hmac-keyring-tsv requires --lane-state-hmac-key-id
// LANESTATEKEYRINGMANIFEST: "hmac_key_id": "lane-ring-a"
// LANESTATEKEYRINGMANIFEST: "lane_state_file": "{{.*}}lane-state-keyring-signed.tsv"
// LANESTATEKEYRINGMANIFEST: "signature_hmac_sha256":
// LANESTATEKEYRINGRESUME: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}10{{[[:space:]]+}}9{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0
// LANESTATEKEYRINGMISSINGID: lane state HMAC keyring missing key_id 'missing'
// LANESTATEKEYRINGSHABAD: lane state HMAC keyring SHA256 mismatch:
// LANESTATEKEYRINGBADDATE: invalid lane state HMAC keyring row {{.*}} not_before: expected YYYY-MM-DD
// LANESTATEKEYRINGWINDOW: lane state HMAC key_id '{{.*}}' not active at generated_at_utc
// CASEUNMATCHED: unmatched expected failure cases:
// CASEUNMATCHED: sv-tests LEC id_kind=base id=missing_case status=FAIL
// CASEOT: opentitan{{[[:space:]]+}}LEC{{[[:space:]]+}}base{{[[:space:]]+}}aes_sbox_canright{{[[:space:]]+}}XFAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}1{{[[:space:]]+}}no{{[[:space:]]+}}known_xprop
// OPENTITANDETAIL: XFAIL{{[[:space:]]+}}aes_sbox_canright{{[[:space:]]+}}aes_sbox_canright{{[[:space:]]+}}opentitan{{[[:space:]]+}}LEC
// CASEAVIP: avip/foo_avip{{[[:space:]]+}}compile{{[[:space:]]+}}base{{[[:space:]]+}}foo_avip{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}1{{[[:space:]]+}}no{{[[:space:]]+}}known_avip_fail
// AVIPDETAIL: FAIL{{[[:space:]]+}}foo_avip{{[[:space:]]+}}{{.*}}/foo_avip{{[[:space:]]+}}avip/foo_avip{{[[:space:]]+}}compile
// EXPECTEDOK: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}0{{[[:space:]]+}}yes{{[[:space:]]+}}known_issue
// JSONEXPECTED: "expected_failures"
// JSONEXPECTED: "unexpected_fail": 0
// EXPECTEDFAIL: unexpected failure budget overruns:
// EXPECTEDFAIL: sv-tests LEC: fail 1 (expected 0), error 0 (expected 0)
// EXPECTEDUNUSED: unused expected-failures entries:
// EXPECTEDUNUSED: missing-suite LEC
// PRUNEBUDGET: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}keep_budget
// PRUNEBUDGET-NOT: missing-suite
// DRYRUNBUDGET: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}9{{[[:space:]]+}}9{{[[:space:]]+}}dry_keep
// REFRESHBUDGET: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}carry_note
// REFRESHCASE: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}__aggregate__{{[[:space:]]+}}aggregate{{[[:space:]]+}}XFAIL{{[[:space:]]+}}2099-12-31
// REFRESHCASE: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}basic02{{[[:space:]]+}}base{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-05-05{{[[:space:]]+}}keep_reason
// REFRESHBUDGETFILTER: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}1{{[[:space:]]+}}0{{[[:space:]]+}}carry_note
// REFRESHBUDGETFILTER-NOT: verilator-verification
// REFRESHCASEFILTER: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}__aggregate__{{[[:space:]]+}}aggregate{{[[:space:]]+}}XFAIL{{[[:space:]]+}}2099-07-07{{[[:space:]]+}}keep_xfail
// REFRESHCASEFILTER-NOT: sv-tests{{[[:space:]]+}}LEC
// REFRESHANY: sv-tests{{[[:space:]]+}}BMC{{[[:space:]]+}}__aggregate__{{[[:space:]]+}}aggregate{{[[:space:]]+}}ANY{{[[:space:]]+}}2099-06-06{{[[:space:]]+}}keep_any
// REFRESHANY: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}basic02{{[[:space:]]+}}base{{[[:space:]]+}}ANY{{[[:space:]]+}}2099-05-05{{[[:space:]]+}}keep_reason
// PRUNECASE: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}basic02{{[[:space:]]+}}base{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}keep_matched
// PRUNECASE-NOT: stale_case
// PRUNECASE-NOT: drop_expired
// DRYRUNCASE: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}stale_case{{[[:space:]]+}}base{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}dry_keep_stale
// DRYRUNREPORT: "hmac_key_id": "lit-key-1"
// DRYRUNREPORT-SAME: "hmac_mode": "sha256-keyfile"
// DRYRUNREPORT-SAME: "operation": "run_meta"
// DRYRUNREPORT-SAME: "report_sample_rows_limit": 5
// DRYRUNREPORT-SAME: "run_id":
// DRYRUNREPORT-SAME: "schema_version": 1
// DRYRUNREPORT: "operation": "refresh_expected_failures"
// DRYRUNREPORT-SAME: "output_rows_sample":
// DRYRUNREPORT: "operation": "refresh_expected_failure_cases"
// DRYRUNREPORT-SAME: "output_rows_sample":
// DRYRUNREPORT: "exit_code": 0
// DRYRUNREPORT-SAME: "hmac_key_id": "lit-key-1"
// DRYRUNREPORT-SAME: "operation": "run_end"
// DRYRUNREPORT-SAME: "payload_hmac_sha256":
// DRYRUNREPORT-SAME: "payload_sha256":
// DRYRUNREPORT-SAME: "row_count": 3
// DRYRUNREPORT-SAME: "run_id":
// DRYRUNVERIFY: verified dry-run report: runs=1
// DRYRUNVERIFYBAD: error: {{.*}}run_end.row_count=99 does not match observed rows=3
// DRYRUNVERIFYHMACBAD: error: {{.*}}run_end.payload_hmac_sha256 mismatch
// DRYRUNVERIFYKEYIDBAD: error: {{.*}}run_meta.hmac_key_id mismatch
// DRYRUNVERIFYKEYRING: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGSHA: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGSHABAD: error: HMAC keyring sha256 mismatch
// DRYRUNVERIFYKEYRINGMANIFEST: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGMANIFESTBAD: error: {{.*}}manifest.signer_id mismatch
// DRYRUNVERIFYKEYRINGMANIFESTED25519: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGMANIFESTED25519BAD: error: {{.*}}manifest.signature_ed25519_base64 verification failed
// DRYRUNVERIFYKEYRINGMANIFESTED25519RING: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGMANIFESTED25519RINGBAD: error: {{.*}}unknown manifest signer_id 'lit-ed25519'
// DRYRUNVERIFYKEYRINGMANIFESTMODEBAD: error: {{.*}}are mutually exclusive
// DRYRUNVERIFYKEYRINGREL: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGKEYSHA: verified dry-run report: runs=1
// DRYRUNVERIFYKEYRINGKEYSHABAD: error: {{.*}}keyring.key_sha256 mismatch
// DRYRUNVERIFYKEYRINGBAD: error: {{.*}}unknown hmac_key_id 'missing-key'
// DRYRUNVERIFYKEYRINGREVOKED: error: {{.*}}hmac_key_id 'lit-key-1' is revoked in keyring
// DRYRUNVERIFYKEYRINGWINDOWBAD: error: {{.*}}run_meta.date '1999-01-01' is before keyring.not_before '2000-01-01'
// DRYRUNVERIFYLEGACYBAD: error: {{.*}}expected operation=run_meta
// DRYRUNVERIFYLEGACY: verified dry-run report: runs=1
// CASEOK: sv-tests{{[[:space:]]+}}LEC{{[[:space:]]+}}base{{[[:space:]]+}}basic02{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}1{{[[:space:]]+}}no{{[[:space:]]+}}known_case
// JSONCASE: "expected_failure_cases"
// JSONCASE: "matched_count": 1
// CASEUNEXPECTED: unexpected observed failure cases:
// CASEUNEXPECTED: sv-tests LEC FAIL base=basic02 path={{.*}}basic02.sv
// CASEEXPIRED: expired expected failure cases:
// CASEEXPIRED: sv-tests LEC id_kind=base id=basic02 expires_on=2000-01-01 matched_count=1
// CASEAGG: yosys/tests/sva{{[[:space:]]+}}BMC{{[[:space:]]+}}aggregate{{[[:space:]]+}}__aggregate__{{[[:space:]]+}}FAIL{{[[:space:]]+}}2099-01-01{{[[:space:]]+}}1{{[[:space:]]+}}no{{[[:space:]]+}}known_yosys_bmc_gap
//
// STRICTXPASS: strict gate failures:
// STRICTXPASS: verilator-verification BMC: xpass increased (0 -> 1, window=1)
//
// STRICTRATE: strict gate failures:
// STRICTRATE: sv-tests LEC: pass_rate regressed (100.000 -> 80.000, window=1)
//
// STRICTWINDOW: strict gate failures:
// STRICTWINDOW: sv-tests LEC: pass_rate regressed (100.000 -> 90.000, window=2)
