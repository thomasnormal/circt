APB AVIP Full Compilation Test - SUCCESS
=========================================
Date: 2026-01-26

Working Command:
----------------
./build/bin/circt-verilog --ir-hw --compat vcs \
  -I ~/mbit/apb_avip/src/globals \
  -I ~/mbit/apb_avip/src/hvl_top/master \
  -I ~/mbit/apb_avip/src/hvl_top/slave \
  -I ~/mbit/apb_avip/src/hvl_top/env \
  -I ~/mbit/apb_avip/src/hvl_top/env/virtual_sequencer \
  -I ~/mbit/apb_avip/src/hvl_top/test \
  -I ~/mbit/apb_avip/src/hvl_top/test/sequences/master_sequences \
  -I ~/mbit/apb_avip/src/hvl_top/test/sequences/slave_sequences \
  -I ~/mbit/apb_avip/src/hvl_top/test/virtual_sequences \
  -I ./lib/Runtime/uvm \
  ./lib/Runtime/uvm/uvm_pkg.sv \
  ~/mbit/apb_avip/src/globals/apb_global_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/master/apb_master_pkg.sv \
  ~/mbit/apb_avip/src/hdl_top/master_agent_bfm/apb_master_driver_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/master_agent_bfm/apb_master_monitor_bfm.sv \
  ~/mbit/apb_avip/src/hvl_top/slave/apb_slave_pkg.sv \
  ~/mbit/apb_avip/src/hdl_top/slave_agent_bfm/apb_slave_driver_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/slave_agent_bfm/apb_slave_monitor_bfm.sv \
  ~/mbit/apb_avip/src/hvl_top/env/apb_env_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/sequences/master_sequences/apb_master_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/sequences/slave_sequences/apb_slave_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/virtual_sequences/apb_virtual_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/apb_test_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/hvl_top.sv

Exit Code: 0 (SUCCESS)

Output: 18,730 lines of MLIR IR (1.7MB)

File Compilation Order (Critical):
----------------------------------
1. UVM Package (CIRCT stub): ./lib/Runtime/uvm/uvm_pkg.sv
2. Global Package: apb_global_pkg.sv
3. Master Package: apb_master_pkg.sv (depends on global, UVM)
4. Master BFMs: apb_master_driver_bfm.sv, apb_master_monitor_bfm.sv (depends on master pkg)
5. Slave Package: apb_slave_pkg.sv (depends on global, UVM)
6. Slave BFMs: apb_slave_driver_bfm.sv, apb_slave_monitor_bfm.sv (depends on slave pkg)
7. Env Package: apb_env_pkg.sv (depends on global, master, slave)
8. Master Sequences: apb_master_seq_pkg.sv (depends on global, master)
9. Slave Sequences: apb_slave_seq_pkg.sv (depends on global, slave)
10. Virtual Sequences: apb_virtual_seq_pkg.sv (depends on all above)
11. Test Package: apb_test_pkg.sv (depends on all above)
12. Top Module: hvl_top.sv (depends on test pkg)

Key Findings:
-------------
- The packages use `include to pull in their component files
- BFM interfaces must be compiled AFTER their corresponding packages (circular dependency handling)
- The CIRCT UVM stub (lib/Runtime/uvm/uvm_pkg.sv) works for this AVIP
- Virtual interface references in driver/monitor proxies work correctly

Warnings (non-fatal):
---------------------
- "unreachable code" warnings in virtual sequences (code after return statements)
- "Class builtin functions... are not yet supported" remark for UVM

Files Compiled Successfully:
----------------------------
- 14 packages/modules total
- globals/apb_global_pkg.sv
- hvl_top/master/apb_master_pkg.sv (+ 11 included files)
- hvl_top/slave/apb_slave_pkg.sv (+ 9 included files)
- hdl_top/master_agent_bfm/*.sv (2 BFMs)
- hdl_top/slave_agent_bfm/*.sv (2 BFMs)
- hvl_top/env/apb_env_pkg.sv (+ 4 included files)
- hvl_top/test/sequences/master_sequences/apb_master_seq_pkg.sv (+ 8 sequences)
- hvl_top/test/sequences/slave_sequences/apb_slave_seq_pkg.sv (+ 8 sequences)
- hvl_top/test/virtual_sequences/apb_virtual_seq_pkg.sv (+ 10 sequences)
- hvl_top/test/apb_test_pkg.sv (+ 9 tests)
- hvl_top/hvl_top.sv

==============================================
FULL APB AVIP COMPILATION (HDL + HVL)
==============================================

Working Command (Full Testbench):
---------------------------------
./build/bin/circt-verilog --ir-hw --compat vcs \
  -I ~/mbit/apb_avip/src/globals \
  -I ~/mbit/apb_avip/src/hvl_top/master \
  -I ~/mbit/apb_avip/src/hvl_top/slave \
  -I ~/mbit/apb_avip/src/hvl_top/env \
  -I ~/mbit/apb_avip/src/hvl_top/env/virtual_sequencer \
  -I ~/mbit/apb_avip/src/hvl_top/test \
  -I ~/mbit/apb_avip/src/hvl_top/test/sequences/master_sequences \
  -I ~/mbit/apb_avip/src/hvl_top/test/sequences/slave_sequences \
  -I ~/mbit/apb_avip/src/hvl_top/test/virtual_sequences \
  -I ./lib/Runtime/uvm \
  ./lib/Runtime/uvm/uvm_pkg.sv \
  ~/mbit/apb_avip/src/globals/apb_global_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/master/apb_master_pkg.sv \
  ~/mbit/apb_avip/src/hdl_top/master_agent_bfm/apb_master_driver_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/master_agent_bfm/apb_master_monitor_bfm.sv \
  ~/mbit/apb_avip/src/hvl_top/slave/apb_slave_pkg.sv \
  ~/mbit/apb_avip/src/hdl_top/slave_agent_bfm/apb_slave_driver_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/slave_agent_bfm/apb_slave_monitor_bfm.sv \
  ~/mbit/apb_avip/src/hvl_top/env/apb_env_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/sequences/master_sequences/apb_master_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/sequences/slave_sequences/apb_slave_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/virtual_sequences/apb_virtual_seq_pkg.sv \
  ~/mbit/apb_avip/src/hvl_top/test/apb_test_pkg.sv \
  ~/mbit/apb_avip/src/hdl_top/apb_if/apb_if.sv \
  ~/mbit/apb_avip/src/hdl_top/master_agent_bfm/apb_master_agent_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/slave_agent_bfm/apb_slave_agent_bfm.sv \
  ~/mbit/apb_avip/src/hdl_top/hdl_top.sv \
  ~/mbit/apb_avip/src/hvl_top/hvl_top.sv

Exit Code: 0 (SUCCESS)

Output Statistics:
- Lines of MLIR IR: 19,706
- File size: 1.8MB

Additional Files Compiled (vs HVL-only):
- apb_if.sv - APB interface definition
- apb_master_agent_bfm.sv - Master agent BFM module
- apb_slave_agent_bfm.sv - Slave agent BFM module
- hdl_top.sv - HDL top module with clock generation

Module Structure:
- hdl_top: Top-level HDL module
  - Contains clock (pclk) and reset (preset_n) generation
  - Instantiates apb_if interfaces (intf, intf_s[])
  - Instantiates apb_master_agent_bfm
  - Generates apb_slave_agent_bfm instances
- hvl_top: Top-level HVL module  
  - Calls run_test() to start UVM simulation

Key Insights:
- Interface arrays (apb_if intf_s[NO_OF_SLAVES]) are supported
- Generate blocks with parameterized instances work correctly
- Module defparam statements are processed
- always_comb with case statements compiles successfully
- Virtual interface references in config_db::set work correctly
