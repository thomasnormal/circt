From: CIRCT Team <circt@llvm.org>
Subject: [PATCH] Allow class handles in logical binary operators

According to SystemVerilog IEEE 1800-2017, class handles should be usable
in boolean contexts (they evaluate to true if non-null, false if null).
This patch fixes the type checking for logical operators (&&, ||, ->, <->)
to accept any boolean-convertible type, not just numeric types.

This fixes an issue when parsing UVM code like:
  if (imp && !m_imp_list.exists(imp.get_full_name()))

Where `imp` is a class handle being used in a logical AND with a `bit`
result from `.exists()`.

diff --git a/source/ast/expressions/OperatorExpressions.cpp b/source/ast/expressions/OperatorExpressions.cpp
index 43f94f6..19b4dfe 100644
--- a/source/ast/expressions/OperatorExpressions.cpp
+++ b/source/ast/expressions/OperatorExpressions.cpp
@@ -814,7 +814,8 @@ Expression& BinaryExpression::fromComponents(Expression& lhs, Expression& rhs, B
         case BinaryOperator::LogicalImplication:
         case BinaryOperator::LogicalEquivalence:
             // Result is always a single bit.
-            good = bothNumeric;
+            // Allow any boolean-convertible types (numeric, class handles, etc.)
+            good = lt->isBooleanConvertible() && rt->isBooleanConvertible();
             result->type = singleBitType(compilation, lt, rt);
             selfDetermined(context, result->left_);
             selfDetermined(context, result->right_);
